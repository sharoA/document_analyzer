# analyDesign 项目使用指南

## 🎯 项目结构（推荐的最佳实践）

```
D:\project\analyDesign\
├── analyDesign_env/          # 虚拟环境（包含 Python 解释器和依赖包）
│   ├── Scripts/
│   │   └── python.exe       # 虚拟环境的 Python 解释器
│   └── Lib/site-packages/   # 安装的 Python 包
├── src/                     # 项目源代码
├── tests/                   # 测试代码
├── templates/               # 模板文件
├── logs/                    # 日志文件
├── outputs/                 # 输出文件
├── uploads/                 # 上传文件
├── run.py                   # 主程序入口
├── requirements.txt         # 依赖列表
└── README.md               # 项目说明
```

## ✅ 为什么选择这种结构？

1. **标准实践**: 这是 Python 项目的业界标准结构
2. **版本控制友好**: 虚拟环境不会被提交到 Git
3. **部署简单**: 只需要项目代码，在目标环境重新创建虚拟环境
4. **团队协作**: 每个开发者可以有自己的虚拟环境
5. **依赖隔离**: 项目依赖与系统 Python 完全隔离

## 🚀 快速开始

### 1. 一键运行项目
```powershell
.\run_project.ps1
```

### 2. 手动运行项目
```powershell
# 运行主程序
.\analyDesign_env\Scripts\python.exe run.py

# 运行配置测试
.\analyDesign_env\Scripts\python.exe src/config.py

# 运行测试
.\analyDesign_env\Scripts\python.exe -m pytest tests/
```

### 3. 激活虚拟环境进行开发
```batch
# 使用批处理文件激活
activate_env.bat

# 激活后可以直接使用 python 命令
python run.py
python src/config.py
```

## 🔧 开发工作流

### 添加新依赖
```powershell
# 1. 激活虚拟环境
activate_env.bat

# 2. 安装新包
pip install 新包名

# 3. 更新依赖列表
pip freeze > requirements.txt
```

### 运行测试
```powershell
# 使用虚拟环境运行测试
.\analyDesign_env\Scripts\python.exe -m pytest tests/ -v
```

### 代码调试
```powershell
# 使用虚拟环境的 Python 进行调试
.\analyDesign_env\Scripts\python.exe -m pdb run.py
```

## 📁 重要文件说明

- **`analyDesign_env/`**: 虚拟环境目录，包含所有 Python 依赖
- **`src/config.py`**: 项目配置文件（已解决 pydantic_settings 问题）
- **`run.py`**: 项目主入口文件
- **`requirements.txt`**: 项目依赖列表
- **`activate_env.bat`**: 环境激活脚本
- **`run_project.ps1`**: 一键运行脚本
- **`setup_env.ps1`**: 环境设置脚本

## 🛠️ 环境管理

### 重新创建环境
```powershell
# 删除现有环境
Remove-Item -Recurse -Force analyDesign_env

# 重新创建
.\setup_env.ps1
```

### 备份环境配置
```powershell
# 导出依赖列表
.\analyDesign_env\Scripts\python.exe -m pip freeze > requirements_backup.txt
```

### 在其他机器上复制环境
```powershell
# 1. 复制项目代码（不包括 analyDesign_env 目录）
# 2. 在新机器上运行
.\setup_env.ps1
```

## 🎯 最佳实践总结

✅ **DO（推荐做法）**:
- 使用虚拟环境运行项目: `.\analyDesign_env\Scripts\python.exe run.py`
- 项目代码保持在根目录
- 使用 `requirements.txt` 管理依赖
- 定期更新依赖列表

❌ **DON'T（不推荐）**:
- 不要将虚拟环境提交到版本控制
- 不要在系统 Python 中安装项目依赖
- 不要手动修改虚拟环境内的文件

## 🔍 故障排除

### 如果项目无法运行
```powershell
# 1. 检查虚拟环境
.\analyDesign_env\Scripts\python.exe --version

# 2. 检查依赖安装
.\analyDesign_env\Scripts\python.exe -c "import pydantic_settings; print('OK')"

# 3. 重新安装依赖
.\analyDesign_env\Scripts\python.exe -m pip install -r requirements.txt
```

### 如果遇到权限问题
```powershell
# 设置 PowerShell 执行策略
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

---

**当前状态**: ✅ 项目环境已配置完成，可以正常使用！ 