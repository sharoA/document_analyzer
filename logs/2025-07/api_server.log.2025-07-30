2025-07-30 18:33:32 - api_server - INFO - 从配置文件读取火山引擎配置: {'api_key': '7fcb3541-9363-4bfa-90aa-19e9f691bc25', 'endpoint': 'https://ark.cn-beijing.volces.com/api/v3', 'max_tokens': 16000, 'model': 'ep-20250605091804-wmw6w', 'temperature': 0.7}
2025-07-30 18:33:33 - api_server - INFO - 火山引擎客户端初始化成功
2025-07-30 18:33:33 - api_server - INFO - Weaviate配置: http://localhost:8080
2025-07-30 18:33:44 - api_server - INFO - 分析服务管理器初始化成功
2025-07-30 18:33:44 - api_server - INFO - 分析服务管理器已集成到API服务器
2025-07-30 18:33:44 - api_server - INFO - 增强分析器初始化成功
2025-07-30 18:33:55 - api_server - INFO - 从配置文件读取火山引擎配置: {'api_key': '7fcb3541-9363-4bfa-90aa-19e9f691bc25', 'endpoint': 'https://ark.cn-beijing.volces.com/api/v3', 'max_tokens': 16000, 'model': 'ep-20250605091804-wmw6w', 'temperature': 0.7}
2025-07-30 18:33:55 - api_server - INFO - 火山引擎客户端初始化成功
2025-07-30 18:33:55 - api_server - INFO - Weaviate配置: http://localhost:8080
2025-07-30 18:34:06 - api_server - INFO - 分析服务管理器初始化成功
2025-07-30 18:34:06 - api_server - INFO - 分析服务管理器已集成到API服务器
2025-07-30 18:34:06 - api_server - INFO - 增强分析器初始化成功
2025-07-30 18:37:46 - api_server - INFO - file_info包含content字段，长度: 1132360
2025-07-30 18:37:46 - api_server - INFO - base64解码成功，file_content类型: <class 'bytes'>, 大小: 849268 bytes
2025-07-30 18:37:46 - api_server - INFO - 任务 903dfe49-190a-4e8f-80c7-e5f28dd77657 进度更新: 0% - 分析流程启动中
2025-07-30 18:37:46 - api_server - INFO - 开始完整分析流程: 903dfe49-190a-4e8f-80c7-e5f28dd77657
2025-07-30 18:37:46 - api_server - INFO - V2 完整分析启动成功: 需求文档 - 一局对接链数优化V0.1.docx, 任务ID: 903dfe49-190a-4e8f-80c7-e5f28dd77657, 大小: 849268 bytes
2025-07-30 18:37:46 - api_server - INFO - 🚀 完整分析流程启动: 903dfe49-190a-4e8f-80c7-e5f28dd77657
2025-07-30 18:37:46 - api_server - INFO - 🚀 V2 完整分析启动: 需求文档 - 一局对接链数优化V0.1.docx, 任务ID: 903dfe49-190a-4e8f-80c7-e5f28dd77657
2025-07-30 18:37:46 - api_server - INFO - ✅ POST start_analysis_v2 [200] (0.02s)
2025-07-30 18:37:46 - api_server - INFO - 任务 903dfe49-190a-4e8f-80c7-e5f28dd77657 进度更新: 10% - 开始文档解析
2025-07-30 18:37:46 - api_server - INFO - 任务 903dfe49-190a-4e8f-80c7-e5f28dd77657 进度更新: 10% - 开始解析文件
2025-07-30 18:37:46 - api_server - INFO - 从文件路径读取: /Users/renyu/Documents/ai_project/document_analyzer/uploads/temp/903dfe49-190a-4e8f-80c7-e5f28dd77657_需求文档 - 一局对接链数优化V0.1.docx
2025-07-30 18:37:46 - api_server - INFO - 使用通用文件分析方法: 903dfe49-190a-4e8f-80c7-e5f28dd77657_需求文档 - 一局对接链数优化V0.1.docx
2025-07-30 18:37:46 - api_server - INFO - 检测到Word文档，使用Markdown转换: 903dfe49-190a-4e8f-80c7-e5f28dd77657_需求文档 - 一局对接链数优化V0.1.docx
2025-07-30 18:37:46 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:37:46 - api_server - INFO - Word文档已成功转换为Markdown格式，长度: 2547 字符
2025-07-30 18:37:46 - api_server - INFO - 提取的文本内容已准备完毕
2025-07-30 18:37:46 - api_server - INFO - 提取的文本内容已准备完毕
2025-07-30 18:37:46 - api_server - INFO - 转换后内容预览: 一局对接链数优化

需求文档

| 版本 | V0.1 |
| --- | --- |
| 撰写人 | 李威明 |
| 类型 | 系统对接 |
| 标签 | 链数、中建一局 |

中企云链（北京）金融信息服务有限公司

文档控制

需求方

| 日期 | 需求人 | 需求部门 | 说明 |
| --- | --- | --- | --- |
| 2025/4/30 | 徐艺 | 金融服务部 |  |

版本记录

| 日期 | 撰写人 | 版本 | 变更说明 |
| --- | --- | --- | --- |
| 2025/4/30 | 李威明 | V0.1 | 创建文档 |

目录

第1章 项目介绍	4

1.1 需求背景	4

1.2 建设目标及路线	4

第2章 整体说明	4

2.1 需求模型	4

2.2 功能结构图	4

2.3 信息结构图	4

2.4 项目范围	4

2.4.1 新增功能	4

2.4.2 调整功能	4

第3章 功能需求说明	4

3.1 调整说明	4

# 项目介绍

## 需求背景

- 一局对接链数的项目上线后，核心企业反馈，希望就已推送至平台的数据，在核心企业内部系统内修改部分信息（如额度信息）后，使用原业务编号再次推送至平台。就目前的接口校验逻辑，相同业务编号的业务数据不可重复推送。因而，需要结合核心企业需求，对接口的校验逻辑进行调整。

## 建设目标及路线

- 调整接口校验逻辑，兼容核心企业重推数据的场景。

# 整体说明

## 需求模型

## 功能结构图

## 信息结构图

## 项目范围

### 新增功能

### 调整功能

# 功能需求说明

## 接口校验规则调整

### 调整说明

本期对【确权业务申请】接口中关于bizSerialNo的校验规则进行调整，调整后的校验规则为：

| 序号 | 接口名称 | 隶属服务 | 校验点 | 逻辑 | 错误提示 |
| --- | --- | --- | --- | --- | --- |
| 1 | 确权业务申请 | zqyl-data-open | 入参校验 | bizSerialNo不可与已成功推送的非“已作废”、“已删除”状态的链数业务数据对应的bizSerialNo成功记录重复 | bizSerialNo已存在，请先登录平台进行作废/删除。 |

## 链数额度功能调整

### 调整说明

本期，对原“链数额度”功能做如下调整：

- 功能名称由“链数额度”变更为“额度管理”；

- 页面右上方新增“组织单元额度”按钮，当且仅当当前登录企业为多组织企业时展示该按钮。用户点击“组织单元额度”按钮，则跳转至“组织单元额度”列表页。

- 列表新增字段“额度类型”，置于“额度名称”之后，若为链数额度则取值为“链数额度”。

![图片2](http://localhost:8082/uploads/temp/903dfe49-190a-4e8f-80c7-e5f28dd77657_img_20250730_183746_1.png)

## 新增组织单元额度功能

### 调整说明

本期在核心企业侧链数额度功能下，新增“组织单元额度”列表页。支持用户查询当前登录企业下的具体组织单元的链数额度、云信额度明细。

具体如下：

- 交互说明：

![图片1](http://localhost:8082/uploads/temp/903dfe49-190a-4e8f-80c7-e5f28dd77657_img_20250730_183746_0.png)

（页面入口：用户点击“额度管理”列表页右上角的“组织单元额度”按钮，跳转至该页面。）

- 返回：用户点击返回，返回至“额度管理”列表页。

- 导出：点击导出，将列表中用户筛选后的数据以xls文件格式导出至本地。

- 列表筛选：用户确定筛选条件后，点击查询按钮，按照用户确定的筛选条件对列表进行筛选；点击重置，列表恢复至未筛选状态。

- 功能说明：

- 列表需展示分配至当前登录企业下所有组织单元的链数额度和云信额度明细。页面载入时，默认展示分配至各组织单元的链数额度明细；若用户将额度类型切换为“云信额度”，则需要展示分配至各组织单元的云信额度明细；若用户将额度类型切换为“全部”，则需要展示分配至各组织单元的链数和云信额度明细。

- 字段说明：

- 筛选字段：

| 序号 | 字段名 | 类型格式 | 长度 | 默认值 | 必填 | 规则 |
| --- | --- | --- | --- | --- | --- | --- |
| 1 | 组织单元名称 | 文本输入框 | - | - | - | 模糊搜索 |
| 2 | 额度名称 | 文本输入框 | - | - | - | 模糊搜索 |
| 3 | 额度类型 | 下拉列表 | - | 链数额度 | - | 下拉选项：链数额度、云信额度、全部 |

- 汇总字段：

| 序号 | 字段名 | 类型格式 | 规则 |
| --- | --- | --- | --- |
| 1 | 总额度（元） | 数值 | 满足筛选条件的列表数据的“已分配额度（元）”之和 |
| 2 | 已用额度（元） | 数值 | 满足筛选条件的列表数据的“已用额度（元）”之和 |
| 3 | 可用额度（元） | 数值 | 满足筛选条件的列表数据的“可用额度（元）”之和 |

- 备注：筛选条件更新后，汇总值需要同步更新计算。

- 列表字段：

| 序号 | 字段名 | 类型格式 | 规则 |
| --- | --- | --- | --- |
| 1 | 组织单元名称 | 字符串 |  |
| 2 | 额度名称 | 字符串 |  |
| 3 | 额度类型 | 字符串 |  |
| 4 | 已分配额度（元） | 数值 |  |
| 5 | 已用额度（元） | 数值 |  |
| 6 | 可用额度（元） | 数值 |  |

- 备注：列表默认按照组织单元名称为主要关键字、额度类型为次要关键字降序排列。
2025-07-30 18:37:46 - api_server - INFO - 提取的文本内容已准备完毕
2025-07-30 18:37:46 - api_server - INFO - 转换后内容预览: 一局对接链数优化

需求文档

| 版本 | V0.1 |
| --- | --- |
| 撰写人 | 李威明 |
| 类型 | 系统对接 |
| 标签 | 链数、中建一局 |

中企云链（北京）金融信息服务有限公司

文档控制

需求方

| 日期 | 需求人 | 需求部门 | 说明 |
| --- | --- | --- | --- |
| 2025/4/30 | 徐艺 | 金融服务部 |  |

版本记录

| 日期 | 撰写人 | 版本 | 变更说明 |
| --- | --- | --- | --- |
| 2025/4/30 | 李威明 | V0.1 | 创建文档 |

目录

第1章 项目介绍	4

1.1 需求背景	4

1.2 建设目标及路线	4

第2章 整体说明	4

2.1 需求模型	4

2.2 功能结构图	4

2.3 信息结构图	4

2.4 项目范围	4

2.4.1 新增功能	4

2.4.2 调整功能	4

第3章 功能需求说明	4

3.1 调整说明	4

# 项目介绍

## 需求背景

- 一局对接链数的项目上线后，核心企业反馈，希望就已推送至平台的数据，在核心企业内部系统内修改部分信息（如额度信息）后，使用原业务编号再次推送至平台。就目前的接口校验逻辑，相同业务编号的业务数据不可重复推送。因而，需要结合核心企业需求，对接口的校验逻辑进行调整。

## 建设目标及路线

- 调整接口校验逻辑，兼容核心企业重推数据的场景。

# 整体说明

## 需求模型

## 功能结构图

## 信息结构图

## 项目范围

### 新增功能

### 调整功能

# 功能需求说明

## 接口校验规则调整

### 调整说明

本期对【确权业务申请】接口中关于bizSerialNo的校验规则进行调整，调整后的校验规则为：

| 序号 | 接口名称 | 隶属服务 | 校验点 | 逻辑 | 错误提示 |
| --- | --- | --- | --- | --- | --- |
| 1 | 确权业务申请 | zqyl-data-open | 入参校验 | bizSerialNo不可与已成功推送的非“已作废”、“已删除”状态的链数业务数据对应的bizSerialNo成功记录重复 | bizSerialNo已存在，请先登录平台进行作废/删除。 |

## 链数额度功能调整

### 调整说明

本期，对原“链数额度”功能做如下调整：

- 功能名称由“链数额度”变更为“额度管理”；

- 页面右上方新增“组织单元额度”按钮，当且仅当当前登录企业为多组织企业时展示该按钮。用户点击“组织单元额度”按钮，则跳转至“组织单元额度”列表页。

- 列表新增字段“额度类型”，置于“额度名称”之后，若为链数额度则取值为“链数额度”。

![图片2](http://localhost:8082/uploads/temp/903dfe49-190a-4e8f-80c7-e5f28dd77657_img_20250730_183746_1.png)

## 新增组织单元额度功能

### 调整说明

本期在核心企业侧链数额度功能下，新增“组织单元额度”列表页。支持用户查询当前登录企业下的具体组织单元的链数额度、云信额度明细。

具体如下：

- 交互说明：

![图片1](http://localhost:8082/uploads/temp/903dfe49-190a-4e8f-80c7-e5f28dd77657_img_20250730_183746_0.png)

（页面入口：用户点击“额度管理”列表页右上角的“组织单元额度”按钮，跳转至该页面。）

- 返回：用户点击返回，返回至“额度管理”列表页。

- 导出：点击导出，将列表中用户筛选后的数据以xls文件格式导出至本地。

- 列表筛选：用户确定筛选条件后，点击查询按钮，按照用户确定的筛选条件对列表进行筛选；点击重置，列表恢复至未筛选状态。

- 功能说明：

- 列表需展示分配至当前登录企业下所有组织单元的链数额度和云信额度明细。页面载入时，默认展示分配至各组织单元的链数额度明细；若用户将额度类型切换为“云信额度”，则需要展示分配至各组织单元的云信额度明细；若用户将额度类型切换为“全部”，则需要展示分配至各组织单元的链数和云信额度明细。

- 字段说明：

- 筛选字段：

| 序号 | 字段名 | 类型格式 | 长度 | 默认值 | 必填 | 规则 |
| --- | --- | --- | --- | --- | --- | --- |
| 1 | 组织单元名称 | 文本输入框 | - | - | - | 模糊搜索 |
| 2 | 额度名称 | 文本输入框 | - | - | - | 模糊搜索 |
| 3 | 额度类型 | 下拉列表 | - | 链数额度 | - | 下拉选项：链数额度、云信额度、全部 |

- 汇总字段：

| 序号 | 字段名 | 类型格式 | 规则 |
| --- | --- | --- | --- |
| 1 | 总额度（元） | 数值 | 满足筛选条件的列表数据的“已分配额度（元）”之和 |
| 2 | 已用额度（元） | 数值 | 满足筛选条件的列表数据的“已用额度（元）”之和 |
| 3 | 可用额度（元） | 数值 | 满足筛选条件的列表数据的“可用额度（元）”之和 |

- 备注：筛选条件更新后，汇总值需要同步更新计算。

- 列表字段：

| 序号 | 字段名 | 类型格式 | 规则 |
| --- | --- | --- | --- |
| 1 | 组织单元名称 | 字符串 |  |
| 2 | 额度名称 | 字符串 |  |
| 3 | 额度类型 | 字符串 |  |
| 4 | 已分配额度（元） | 数值 |  |
| 5 | 已用额度（元） | 数值 |  |
| 6 | 可用额度（元） | 数值 |  |

- 备注：列表默认按照组织单元名称为主要关键字、额度类型为次要关键字降序排列。
2025-07-30 18:37:46 - api_server - INFO - 任务 903dfe49-190a-4e8f-80c7-e5f28dd77657 进度更新: 40% - 使用分析服务解析文档
2025-07-30 18:37:48 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:37:50 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:37:52 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:37:54 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:37:56 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:37:58 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:00 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:02 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:04 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:06 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:08 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:10 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:12 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:12 - api_server - INFO - 任务 903dfe49-190a-4e8f-80c7-e5f28dd77657 进度更新: 100% - 文档解析完成
2025-07-30 18:38:12 - api_server - INFO - ✅ 文件解析完成: 903dfe49-190a-4e8f-80c7-e5f28dd77657
2025-07-30 18:38:12 - api_server - INFO - 任务 903dfe49-190a-4e8f-80c7-e5f28dd77657 进度更新: 40% - 开始内容分析
2025-07-30 18:38:12 - api_server - INFO - 🔍 开始内容分析任务: 903dfe49-190a-4e8f-80c7-e5f28dd77657
2025-07-30 18:38:12 - api_server - INFO - 📊 任务当前状态: content_analyzing
2025-07-30 18:38:12 - api_server - INFO - 📊 任务当前进度: 40%
2025-07-30 18:38:12 - api_server - INFO - 📊 解析结果存在: True
2025-07-30 18:38:12 - api_server - INFO - 📊 分析服务管理器可用: True
2025-07-30 18:38:12 - api_server - INFO - 任务 903dfe49-190a-4e8f-80c7-e5f28dd77657 进度更新: 10% - 开始内容分析
2025-07-30 18:38:12 - api_server - INFO - ✅ 任务状态已更新为: content_analyzing
2025-07-30 18:38:12 - api_server - INFO - 从文件路径读取: /Users/renyu/Documents/ai_project/document_analyzer/uploads/temp/903dfe49-190a-4e8f-80c7-e5f28dd77657_需求文档 - 一局对接链数优化V0.1.docx
2025-07-30 18:38:12 - api_server - INFO - 使用通用文件分析方法: 903dfe49-190a-4e8f-80c7-e5f28dd77657_需求文档 - 一局对接链数优化V0.1.docx
2025-07-30 18:38:12 - api_server - INFO - 检测到Word文档，使用Markdown转换: 903dfe49-190a-4e8f-80c7-e5f28dd77657_需求文档 - 一局对接链数优化V0.1.docx
2025-07-30 18:38:12 - api_server - INFO - Word文档已成功转换为Markdown格式，长度: 2547 字符
2025-07-30 18:38:12 - api_server - INFO - 提取的文本内容已准备完毕
2025-07-30 18:38:12 - api_server - INFO - 任务 903dfe49-190a-4e8f-80c7-e5f28dd77657 进度更新: 30% - 获取到上传文件
2025-07-30 18:38:12 - api_server - INFO - 📄 提取到文档内容，长度: 2547 字符
2025-07-30 18:38:12 - api_server - INFO - 任务 903dfe49-190a-4e8f-80c7-e5f28dd77657 进度更新: 35% - 内容分析管理器开始分析
2025-07-30 18:38:14 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:16 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:18 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:20 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:22 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:24 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:26 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:28 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:30 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:32 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:34 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:36 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:38 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:40 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:42 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:44 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:46 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:48 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:50 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:52 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:54 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:56 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:38:58 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:00 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:02 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:04 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:06 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:08 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:10 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:12 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:14 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:16 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:18 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:20 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:22 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:24 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:26 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:28 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:30 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:32 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:34 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:36 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:38 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:41 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:43 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:45 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:47 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:49 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:51 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:53 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:55 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:57 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:39:59 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:01 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:03 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:05 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:07 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:09 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:11 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:13 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:15 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:17 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:19 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:21 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:23 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:25 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:27 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:29 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:31 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:33 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:35 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:37 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:39 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:41 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:43 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:45 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:47 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:49 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:51 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:53 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:55 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:57 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:40:59 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:01 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:03 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:05 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:06 - api_server - INFO - 任务 903dfe49-190a-4e8f-80c7-e5f28dd77657 进度更新: 100% - 内容分析完成
2025-07-30 18:41:06 - api_server - INFO - ✅ 内容分析完成: 903dfe49-190a-4e8f-80c7-e5f28dd77657
2025-07-30 18:41:06 - api_server - INFO - 任务 903dfe49-190a-4e8f-80c7-e5f28dd77657 进度更新: 70% - 开始AI设计方案
2025-07-30 18:41:06 - api_server - INFO - 🤖 开始AI分析任务: 903dfe49-190a-4e8f-80c7-e5f28dd77657
2025-07-30 18:41:06 - api_server - INFO - 任务 903dfe49-190a-4e8f-80c7-e5f28dd77657 进度更新: 10% - 开始AI设计方案
2025-07-30 18:41:06 - api_server - INFO - 任务 903dfe49-190a-4e8f-80c7-e5f28dd77657 进度更新: 30% - 使用分析服务进行AI分析
2025-07-30 18:41:07 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:09 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:11 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:13 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:15 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:17 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:19 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:21 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:23 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:25 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:27 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:29 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:31 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:33 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:35 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:37 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:39 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:41 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:43 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:45 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:47 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:49 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:51 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:53 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:55 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:57 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:41:59 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:01 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:03 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:05 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:07 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:09 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:11 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:13 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:15 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:17 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:19 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:21 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:23 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:26 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:28 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:30 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:32 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:34 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:36 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:38 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:40 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:42 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:44 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:46 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:48 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:50 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:52 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:54 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:56 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:42:58 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:00 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:02 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:04 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:06 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:08 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:10 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:12 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:14 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:16 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:18 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:20 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:22 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:24 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:26 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:28 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:30 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:32 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:34 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:36 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:38 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:40 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:42 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:44 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:46 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:48 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:50 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:52 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:54 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:56 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:43:58 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:44:00 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:44:02 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:44:04 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:44:06 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:44:08 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:44:10 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:44:12 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:44:14 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:44:16 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:44:18 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:44:20 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:44:22 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:44:24 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:44:26 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:44:28 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:44:30 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:44:32 - api_server - ERROR - 任务 903dfe49-190a-4e8f-80c7-e5f28dd77657 AI分析失败: object dict can't be used in 'await' expression
2025-07-30 18:44:32 - api_server - ERROR - ❌ 任务 903dfe49-190a-4e8f-80c7-e5f28dd77657 AI分析失败: object dict can't be used in 'await' expression
2025-07-30 18:44:32 - api_server - INFO - 任务 903dfe49-190a-4e8f-80c7-e5f28dd77657 进度更新: 30% - AI分析失败: object dict can't be used in 'await' expression
2025-07-30 18:44:32 - api_server - ERROR - AI分析失败: 903dfe49-190a-4e8f-80c7-e5f28dd77657, 当前状态: failed, 错误信息: AI分析失败: object dict can't be used in 'await' expression
2025-07-30 18:44:32 - api_server - INFO - 检测到form_data已生成，继续完成流程: 903dfe49-190a-4e8f-80c7-e5f28dd77657
2025-07-30 18:44:32 - api_server - INFO - 任务 903dfe49-190a-4e8f-80c7-e5f28dd77657 进度更新: 100% - 完整分析流程完成
2025-07-30 18:44:32 - api_server - INFO - 完整分析流程成功完成: 903dfe49-190a-4e8f-80c7-e5f28dd77657
2025-07-30 18:44:32 - api_server - INFO - 🎉 完整分析流程完成: 903dfe49-190a-4e8f-80c7-e5f28dd77657
2025-07-30 18:44:32 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:44:32 - api_server - INFO - 收到设计方案表单数据获取请求: 任务ID=903dfe49-190a-4e8f-80c7-e5f28dd77657
2025-07-30 18:44:32 - api_server - INFO - 设计方案表单数据获取成功: 任务ID=903dfe49-190a-4e8f-80c7-e5f28dd77657, 表单字段数=11
2025-07-30 18:44:32 - api_server - INFO - ✅ GET get_design_form_data [200] (0.00s)
2025-07-30 18:44:32 - api_server - INFO - 🔍 数据类型诊断 - parsing_result: <class 'dict'>
2025-07-30 18:44:32 - api_server - INFO - 🔍 数据类型诊断 - content_analysis: <class 'dict'>
2025-07-30 18:44:32 - api_server - INFO - 🔍 数据类型诊断 - ai_analysis: <class 'dict'>
2025-07-30 18:44:32 - api_server - INFO - ✅ GET get_analysis_result [200] (0.00s)
2025-07-30 18:54:06 - api_server - INFO - file_info包含content字段，长度: 1132360
2025-07-30 18:54:06 - api_server - INFO - base64解码成功，file_content类型: <class 'bytes'>, 大小: 849268 bytes
2025-07-30 18:54:06 - api_server - INFO - 任务 04002cca-1b3d-4a6a-87c1-4d50b2611293 进度更新: 0% - 分析流程启动中
2025-07-30 18:54:06 - api_server - INFO - V2 完整分析启动成功: 需求文档 - 一局对接链数优化V0.1.docx, 任务ID: 04002cca-1b3d-4a6a-87c1-4d50b2611293, 大小: 849268 bytes
2025-07-30 18:54:06 - api_server - INFO - 🚀 V2 完整分析启动: 需求文档 - 一局对接链数优化V0.1.docx, 任务ID: 04002cca-1b3d-4a6a-87c1-4d50b2611293
2025-07-30 18:54:06 - api_server - INFO - 开始完整分析流程: 04002cca-1b3d-4a6a-87c1-4d50b2611293
2025-07-30 18:54:06 - api_server - INFO - ✅ POST start_analysis_v2 [200] (0.01s)
2025-07-30 18:54:06 - api_server - INFO - 🚀 完整分析流程启动: 04002cca-1b3d-4a6a-87c1-4d50b2611293
2025-07-30 18:54:06 - api_server - INFO - 任务 04002cca-1b3d-4a6a-87c1-4d50b2611293 进度更新: 10% - 开始文档解析
2025-07-30 18:54:06 - api_server - INFO - 任务 04002cca-1b3d-4a6a-87c1-4d50b2611293 进度更新: 10% - 开始解析文件
2025-07-30 18:54:06 - api_server - INFO - 从文件路径读取: /Users/renyu/Documents/ai_project/document_analyzer/uploads/temp/04002cca-1b3d-4a6a-87c1-4d50b2611293_需求文档 - 一局对接链数优化V0.1.docx
2025-07-30 18:54:06 - api_server - INFO - 使用通用文件分析方法: 04002cca-1b3d-4a6a-87c1-4d50b2611293_需求文档 - 一局对接链数优化V0.1.docx
2025-07-30 18:54:06 - api_server - INFO - 检测到Word文档，使用Markdown转换: 04002cca-1b3d-4a6a-87c1-4d50b2611293_需求文档 - 一局对接链数优化V0.1.docx
2025-07-30 18:54:06 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:54:06 - api_server - INFO - Word文档已成功转换为Markdown格式，长度: 2547 字符
2025-07-30 18:54:06 - api_server - INFO - 提取的文本内容已准备完毕
2025-07-30 18:54:06 - api_server - INFO - 提取的文本内容已准备完毕
2025-07-30 18:54:06 - api_server - INFO - 转换后内容预览: 一局对接链数优化

需求文档

| 版本 | V0.1 |
| --- | --- |
| 撰写人 | 李威明 |
| 类型 | 系统对接 |
| 标签 | 链数、中建一局 |

中企云链（北京）金融信息服务有限公司

文档控制

需求方

| 日期 | 需求人 | 需求部门 | 说明 |
| --- | --- | --- | --- |
| 2025/4/30 | 徐艺 | 金融服务部 |  |

版本记录

| 日期 | 撰写人 | 版本 | 变更说明 |
| --- | --- | --- | --- |
| 2025/4/30 | 李威明 | V0.1 | 创建文档 |

目录

第1章 项目介绍	4

1.1 需求背景	4

1.2 建设目标及路线	4

第2章 整体说明	4

2.1 需求模型	4

2.2 功能结构图	4

2.3 信息结构图	4

2.4 项目范围	4

2.4.1 新增功能	4

2.4.2 调整功能	4

第3章 功能需求说明	4

3.1 调整说明	4

# 项目介绍

## 需求背景

- 一局对接链数的项目上线后，核心企业反馈，希望就已推送至平台的数据，在核心企业内部系统内修改部分信息（如额度信息）后，使用原业务编号再次推送至平台。就目前的接口校验逻辑，相同业务编号的业务数据不可重复推送。因而，需要结合核心企业需求，对接口的校验逻辑进行调整。

## 建设目标及路线

- 调整接口校验逻辑，兼容核心企业重推数据的场景。

# 整体说明

## 需求模型

## 功能结构图

## 信息结构图

## 项目范围

### 新增功能

### 调整功能

# 功能需求说明

## 接口校验规则调整

### 调整说明

本期对【确权业务申请】接口中关于bizSerialNo的校验规则进行调整，调整后的校验规则为：

| 序号 | 接口名称 | 隶属服务 | 校验点 | 逻辑 | 错误提示 |
| --- | --- | --- | --- | --- | --- |
| 1 | 确权业务申请 | zqyl-data-open | 入参校验 | bizSerialNo不可与已成功推送的非“已作废”、“已删除”状态的链数业务数据对应的bizSerialNo成功记录重复 | bizSerialNo已存在，请先登录平台进行作废/删除。 |

## 链数额度功能调整

### 调整说明

本期，对原“链数额度”功能做如下调整：

- 功能名称由“链数额度”变更为“额度管理”；

- 页面右上方新增“组织单元额度”按钮，当且仅当当前登录企业为多组织企业时展示该按钮。用户点击“组织单元额度”按钮，则跳转至“组织单元额度”列表页。

- 列表新增字段“额度类型”，置于“额度名称”之后，若为链数额度则取值为“链数额度”。

![图片2](http://localhost:8082/uploads/temp/04002cca-1b3d-4a6a-87c1-4d50b2611293_img_20250730_185406_1.png)

## 新增组织单元额度功能

### 调整说明

本期在核心企业侧链数额度功能下，新增“组织单元额度”列表页。支持用户查询当前登录企业下的具体组织单元的链数额度、云信额度明细。

具体如下：

- 交互说明：

![图片1](http://localhost:8082/uploads/temp/04002cca-1b3d-4a6a-87c1-4d50b2611293_img_20250730_185406_0.png)

（页面入口：用户点击“额度管理”列表页右上角的“组织单元额度”按钮，跳转至该页面。）

- 返回：用户点击返回，返回至“额度管理”列表页。

- 导出：点击导出，将列表中用户筛选后的数据以xls文件格式导出至本地。

- 列表筛选：用户确定筛选条件后，点击查询按钮，按照用户确定的筛选条件对列表进行筛选；点击重置，列表恢复至未筛选状态。

- 功能说明：

- 列表需展示分配至当前登录企业下所有组织单元的链数额度和云信额度明细。页面载入时，默认展示分配至各组织单元的链数额度明细；若用户将额度类型切换为“云信额度”，则需要展示分配至各组织单元的云信额度明细；若用户将额度类型切换为“全部”，则需要展示分配至各组织单元的链数和云信额度明细。

- 字段说明：

- 筛选字段：

| 序号 | 字段名 | 类型格式 | 长度 | 默认值 | 必填 | 规则 |
| --- | --- | --- | --- | --- | --- | --- |
| 1 | 组织单元名称 | 文本输入框 | - | - | - | 模糊搜索 |
| 2 | 额度名称 | 文本输入框 | - | - | - | 模糊搜索 |
| 3 | 额度类型 | 下拉列表 | - | 链数额度 | - | 下拉选项：链数额度、云信额度、全部 |

- 汇总字段：

| 序号 | 字段名 | 类型格式 | 规则 |
| --- | --- | --- | --- |
| 1 | 总额度（元） | 数值 | 满足筛选条件的列表数据的“已分配额度（元）”之和 |
| 2 | 已用额度（元） | 数值 | 满足筛选条件的列表数据的“已用额度（元）”之和 |
| 3 | 可用额度（元） | 数值 | 满足筛选条件的列表数据的“可用额度（元）”之和 |

- 备注：筛选条件更新后，汇总值需要同步更新计算。

- 列表字段：

| 序号 | 字段名 | 类型格式 | 规则 |
| --- | --- | --- | --- |
| 1 | 组织单元名称 | 字符串 |  |
| 2 | 额度名称 | 字符串 |  |
| 3 | 额度类型 | 字符串 |  |
| 4 | 已分配额度（元） | 数值 |  |
| 5 | 已用额度（元） | 数值 |  |
| 6 | 可用额度（元） | 数值 |  |

- 备注：列表默认按照组织单元名称为主要关键字、额度类型为次要关键字降序排列。
2025-07-30 18:54:06 - api_server - INFO - 提取的文本内容已准备完毕
2025-07-30 18:54:06 - api_server - INFO - 转换后内容预览: 一局对接链数优化

需求文档

| 版本 | V0.1 |
| --- | --- |
| 撰写人 | 李威明 |
| 类型 | 系统对接 |
| 标签 | 链数、中建一局 |

中企云链（北京）金融信息服务有限公司

文档控制

需求方

| 日期 | 需求人 | 需求部门 | 说明 |
| --- | --- | --- | --- |
| 2025/4/30 | 徐艺 | 金融服务部 |  |

版本记录

| 日期 | 撰写人 | 版本 | 变更说明 |
| --- | --- | --- | --- |
| 2025/4/30 | 李威明 | V0.1 | 创建文档 |

目录

第1章 项目介绍	4

1.1 需求背景	4

1.2 建设目标及路线	4

第2章 整体说明	4

2.1 需求模型	4

2.2 功能结构图	4

2.3 信息结构图	4

2.4 项目范围	4

2.4.1 新增功能	4

2.4.2 调整功能	4

第3章 功能需求说明	4

3.1 调整说明	4

# 项目介绍

## 需求背景

- 一局对接链数的项目上线后，核心企业反馈，希望就已推送至平台的数据，在核心企业内部系统内修改部分信息（如额度信息）后，使用原业务编号再次推送至平台。就目前的接口校验逻辑，相同业务编号的业务数据不可重复推送。因而，需要结合核心企业需求，对接口的校验逻辑进行调整。

## 建设目标及路线

- 调整接口校验逻辑，兼容核心企业重推数据的场景。

# 整体说明

## 需求模型

## 功能结构图

## 信息结构图

## 项目范围

### 新增功能

### 调整功能

# 功能需求说明

## 接口校验规则调整

### 调整说明

本期对【确权业务申请】接口中关于bizSerialNo的校验规则进行调整，调整后的校验规则为：

| 序号 | 接口名称 | 隶属服务 | 校验点 | 逻辑 | 错误提示 |
| --- | --- | --- | --- | --- | --- |
| 1 | 确权业务申请 | zqyl-data-open | 入参校验 | bizSerialNo不可与已成功推送的非“已作废”、“已删除”状态的链数业务数据对应的bizSerialNo成功记录重复 | bizSerialNo已存在，请先登录平台进行作废/删除。 |

## 链数额度功能调整

### 调整说明

本期，对原“链数额度”功能做如下调整：

- 功能名称由“链数额度”变更为“额度管理”；

- 页面右上方新增“组织单元额度”按钮，当且仅当当前登录企业为多组织企业时展示该按钮。用户点击“组织单元额度”按钮，则跳转至“组织单元额度”列表页。

- 列表新增字段“额度类型”，置于“额度名称”之后，若为链数额度则取值为“链数额度”。

![图片2](http://localhost:8082/uploads/temp/04002cca-1b3d-4a6a-87c1-4d50b2611293_img_20250730_185406_1.png)

## 新增组织单元额度功能

### 调整说明

本期在核心企业侧链数额度功能下，新增“组织单元额度”列表页。支持用户查询当前登录企业下的具体组织单元的链数额度、云信额度明细。

具体如下：

- 交互说明：

![图片1](http://localhost:8082/uploads/temp/04002cca-1b3d-4a6a-87c1-4d50b2611293_img_20250730_185406_0.png)

（页面入口：用户点击“额度管理”列表页右上角的“组织单元额度”按钮，跳转至该页面。）

- 返回：用户点击返回，返回至“额度管理”列表页。

- 导出：点击导出，将列表中用户筛选后的数据以xls文件格式导出至本地。

- 列表筛选：用户确定筛选条件后，点击查询按钮，按照用户确定的筛选条件对列表进行筛选；点击重置，列表恢复至未筛选状态。

- 功能说明：

- 列表需展示分配至当前登录企业下所有组织单元的链数额度和云信额度明细。页面载入时，默认展示分配至各组织单元的链数额度明细；若用户将额度类型切换为“云信额度”，则需要展示分配至各组织单元的云信额度明细；若用户将额度类型切换为“全部”，则需要展示分配至各组织单元的链数和云信额度明细。

- 字段说明：

- 筛选字段：

| 序号 | 字段名 | 类型格式 | 长度 | 默认值 | 必填 | 规则 |
| --- | --- | --- | --- | --- | --- | --- |
| 1 | 组织单元名称 | 文本输入框 | - | - | - | 模糊搜索 |
| 2 | 额度名称 | 文本输入框 | - | - | - | 模糊搜索 |
| 3 | 额度类型 | 下拉列表 | - | 链数额度 | - | 下拉选项：链数额度、云信额度、全部 |

- 汇总字段：

| 序号 | 字段名 | 类型格式 | 规则 |
| --- | --- | --- | --- |
| 1 | 总额度（元） | 数值 | 满足筛选条件的列表数据的“已分配额度（元）”之和 |
| 2 | 已用额度（元） | 数值 | 满足筛选条件的列表数据的“已用额度（元）”之和 |
| 3 | 可用额度（元） | 数值 | 满足筛选条件的列表数据的“可用额度（元）”之和 |

- 备注：筛选条件更新后，汇总值需要同步更新计算。

- 列表字段：

| 序号 | 字段名 | 类型格式 | 规则 |
| --- | --- | --- | --- |
| 1 | 组织单元名称 | 字符串 |  |
| 2 | 额度名称 | 字符串 |  |
| 3 | 额度类型 | 字符串 |  |
| 4 | 已分配额度（元） | 数值 |  |
| 5 | 已用额度（元） | 数值 |  |
| 6 | 可用额度（元） | 数值 |  |

- 备注：列表默认按照组织单元名称为主要关键字、额度类型为次要关键字降序排列。
2025-07-30 18:54:06 - api_server - INFO - 任务 04002cca-1b3d-4a6a-87c1-4d50b2611293 进度更新: 40% - 使用分析服务解析文档
2025-07-30 18:54:08 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:54:10 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:54:12 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:54:14 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:54:16 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:54:18 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:54:20 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:54:22 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:54:24 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:54:26 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:54:27 - api_server - INFO - 任务 04002cca-1b3d-4a6a-87c1-4d50b2611293 进度更新: 100% - 文档解析完成
2025-07-30 18:54:27 - api_server - INFO - ✅ 文件解析完成: 04002cca-1b3d-4a6a-87c1-4d50b2611293
2025-07-30 18:54:27 - api_server - INFO - 任务 04002cca-1b3d-4a6a-87c1-4d50b2611293 进度更新: 40% - 开始内容分析
2025-07-30 18:54:27 - api_server - INFO - 🔍 开始内容分析任务: 04002cca-1b3d-4a6a-87c1-4d50b2611293
2025-07-30 18:54:27 - api_server - INFO - 📊 任务当前状态: content_analyzing
2025-07-30 18:54:27 - api_server - INFO - 📊 任务当前进度: 40%
2025-07-30 18:54:27 - api_server - INFO - 📊 解析结果存在: True
2025-07-30 18:54:27 - api_server - INFO - 📊 分析服务管理器可用: True
2025-07-30 18:54:27 - api_server - INFO - 任务 04002cca-1b3d-4a6a-87c1-4d50b2611293 进度更新: 10% - 开始内容分析
2025-07-30 18:54:27 - api_server - INFO - ✅ 任务状态已更新为: content_analyzing
2025-07-30 18:54:27 - api_server - INFO - 从文件路径读取: /Users/renyu/Documents/ai_project/document_analyzer/uploads/temp/04002cca-1b3d-4a6a-87c1-4d50b2611293_需求文档 - 一局对接链数优化V0.1.docx
2025-07-30 18:54:27 - api_server - INFO - 使用通用文件分析方法: 04002cca-1b3d-4a6a-87c1-4d50b2611293_需求文档 - 一局对接链数优化V0.1.docx
2025-07-30 18:54:27 - api_server - INFO - 检测到Word文档，使用Markdown转换: 04002cca-1b3d-4a6a-87c1-4d50b2611293_需求文档 - 一局对接链数优化V0.1.docx
2025-07-30 18:54:27 - api_server - INFO - Word文档已成功转换为Markdown格式，长度: 2547 字符
2025-07-30 18:54:27 - api_server - INFO - 提取的文本内容已准备完毕
2025-07-30 18:54:27 - api_server - INFO - 任务 04002cca-1b3d-4a6a-87c1-4d50b2611293 进度更新: 30% - 获取到上传文件
2025-07-30 18:54:27 - api_server - INFO - 📄 提取到文档内容，长度: 2547 字符
2025-07-30 18:54:27 - api_server - INFO - 任务 04002cca-1b3d-4a6a-87c1-4d50b2611293 进度更新: 35% - 内容分析管理器开始分析
2025-07-30 18:54:28 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:54:30 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:54:32 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:54:34 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:54:36 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:54:38 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:54:40 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:54:42 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:54:44 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:54:46 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:54:48 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:54:50 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:54:52 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:54:54 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:54:56 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:54:58 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:00 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:02 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:04 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:06 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:08 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:10 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:12 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:14 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:16 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:18 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:20 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:22 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:24 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:26 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:28 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:30 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:32 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:34 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:36 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:38 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:40 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:43 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:45 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:47 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:49 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:51 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:53 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:55 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:57 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:55:59 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:01 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:03 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:05 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:07 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:09 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:11 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:13 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:15 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:17 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:19 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:21 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:23 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:25 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:27 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:29 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:31 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:33 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:35 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:37 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:39 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:41 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:43 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:45 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:47 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:49 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:51 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:53 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:55 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:56 - api_server - INFO - 任务 04002cca-1b3d-4a6a-87c1-4d50b2611293 进度更新: 100% - 内容分析完成
2025-07-30 18:56:56 - api_server - INFO - ✅ 内容分析完成: 04002cca-1b3d-4a6a-87c1-4d50b2611293
2025-07-30 18:56:56 - api_server - INFO - 任务 04002cca-1b3d-4a6a-87c1-4d50b2611293 进度更新: 70% - 开始AI设计方案
2025-07-30 18:56:56 - api_server - INFO - 🤖 开始AI分析任务: 04002cca-1b3d-4a6a-87c1-4d50b2611293
2025-07-30 18:56:56 - api_server - INFO - 任务 04002cca-1b3d-4a6a-87c1-4d50b2611293 进度更新: 10% - 开始AI设计方案
2025-07-30 18:56:56 - api_server - INFO - 任务 04002cca-1b3d-4a6a-87c1-4d50b2611293 进度更新: 30% - 使用分析服务进行AI分析
2025-07-30 18:56:57 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:56:59 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:01 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:03 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:05 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:07 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:09 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:11 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:13 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:15 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:17 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:19 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:21 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:23 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:25 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:27 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:29 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:31 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:33 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:35 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:37 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:39 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:41 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:43 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:45 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:47 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:49 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:51 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:53 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:55 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:57 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:57:59 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:01 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:03 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:05 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:07 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:09 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:11 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:13 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:15 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:17 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:19 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:21 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:23 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:25 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:27 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:29 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:31 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:34 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:36 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:38 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:40 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:42 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:44 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:46 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:48 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:50 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:52 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:54 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:56 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:58:58 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:00 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:02 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:04 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:06 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:08 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:10 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:12 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:14 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:16 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:18 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:20 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:22 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:24 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:26 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:28 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:30 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:32 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:34 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:36 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:38 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:40 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:42 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:44 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:46 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:48 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:50 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:52 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:54 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:56 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 18:59:58 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:00:00 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:00:02 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:00:04 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:00:06 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:00:08 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:00:10 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:00:12 - api_server - ERROR - 任务 04002cca-1b3d-4a6a-87c1-4d50b2611293 AI分析失败: object dict can't be used in 'await' expression
2025-07-30 19:00:12 - api_server - ERROR - ❌ 任务 04002cca-1b3d-4a6a-87c1-4d50b2611293 AI分析失败: object dict can't be used in 'await' expression
2025-07-30 19:00:12 - api_server - INFO - 任务 04002cca-1b3d-4a6a-87c1-4d50b2611293 进度更新: 30% - AI分析失败: object dict can't be used in 'await' expression
2025-07-30 19:00:12 - api_server - ERROR - AI分析失败: 04002cca-1b3d-4a6a-87c1-4d50b2611293, 当前状态: failed, 错误信息: AI分析失败: object dict can't be used in 'await' expression
2025-07-30 19:00:12 - api_server - INFO - 检测到form_data已生成，继续完成流程: 04002cca-1b3d-4a6a-87c1-4d50b2611293
2025-07-30 19:00:12 - api_server - INFO - 任务 04002cca-1b3d-4a6a-87c1-4d50b2611293 进度更新: 100% - 完整分析流程完成
2025-07-30 19:00:12 - api_server - INFO - 完整分析流程成功完成: 04002cca-1b3d-4a6a-87c1-4d50b2611293
2025-07-30 19:00:12 - api_server - INFO - 🎉 完整分析流程完成: 04002cca-1b3d-4a6a-87c1-4d50b2611293
2025-07-30 19:00:12 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:00:12 - api_server - INFO - 收到设计方案表单数据获取请求: 任务ID=04002cca-1b3d-4a6a-87c1-4d50b2611293
2025-07-30 19:00:12 - api_server - INFO - 🔍 数据类型诊断 - parsing_result: <class 'dict'>
2025-07-30 19:00:12 - api_server - INFO - 🔍 数据类型诊断 - content_analysis: <class 'dict'>
2025-07-30 19:00:12 - api_server - INFO - 🔍 数据类型诊断 - ai_analysis: <class 'dict'>
2025-07-30 19:00:12 - api_server - INFO - 设计方案表单数据获取成功: 任务ID=04002cca-1b3d-4a6a-87c1-4d50b2611293, 表单字段数=11
2025-07-30 19:00:12 - api_server - INFO - ✅ GET get_design_form_data [200] (0.00s)
2025-07-30 19:00:12 - api_server - INFO - ✅ GET get_analysis_result [200] (0.00s)
2025-07-30 19:01:19 - api_server - INFO - 收到设计方案表单数据更新请求: 任务ID=04002cca-1b3d-4a6a-87c1-4d50b2611293
2025-07-30 19:01:19 - api_server - INFO - 设计方案表单数据更新成功: 任务ID=04002cca-1b3d-4a6a-87c1-4d50b2611293, 表单字段数=12, Markdown长度=12407
2025-07-30 19:01:19 - api_server - INFO - ✅ PUT update_design_form_data [200] (0.00s)
2025-07-30 19:03:09 - api_server - INFO - ✅ POST coder_agent_api.process_design_document [200] (75.52s)
2025-07-30 19:31:56 - api_server - INFO - file_info包含content字段，长度: 1132360
2025-07-30 19:31:56 - api_server - INFO - base64解码成功，file_content类型: <class 'bytes'>, 大小: 849268 bytes
2025-07-30 19:31:56 - api_server - INFO - 任务 766532ce-cdc9-4035-8d2c-e04df211d693 进度更新: 0% - 分析流程启动中
2025-07-30 19:31:56 - api_server - INFO - V2 完整分析启动成功: 需求文档 - 一局对接链数优化V0.1.docx, 任务ID: 766532ce-cdc9-4035-8d2c-e04df211d693, 大小: 849268 bytes
2025-07-30 19:31:56 - api_server - INFO - 开始完整分析流程: 766532ce-cdc9-4035-8d2c-e04df211d693
2025-07-30 19:31:56 - api_server - INFO - 🚀 V2 完整分析启动: 需求文档 - 一局对接链数优化V0.1.docx, 任务ID: 766532ce-cdc9-4035-8d2c-e04df211d693
2025-07-30 19:31:56 - api_server - INFO - 🚀 完整分析流程启动: 766532ce-cdc9-4035-8d2c-e04df211d693
2025-07-30 19:31:56 - api_server - INFO - ✅ POST start_analysis_v2 [200] (0.02s)
2025-07-30 19:31:56 - api_server - INFO - 任务 766532ce-cdc9-4035-8d2c-e04df211d693 进度更新: 10% - 开始文档解析
2025-07-30 19:31:56 - api_server - INFO - 任务 766532ce-cdc9-4035-8d2c-e04df211d693 进度更新: 10% - 开始解析文件
2025-07-30 19:31:56 - api_server - INFO - 从文件路径读取: /Users/renyu/Documents/ai_project/document_analyzer/uploads/temp/766532ce-cdc9-4035-8d2c-e04df211d693_需求文档 - 一局对接链数优化V0.1.docx
2025-07-30 19:31:56 - api_server - INFO - 使用通用文件分析方法: 766532ce-cdc9-4035-8d2c-e04df211d693_需求文档 - 一局对接链数优化V0.1.docx
2025-07-30 19:31:56 - api_server - INFO - 检测到Word文档，使用Markdown转换: 766532ce-cdc9-4035-8d2c-e04df211d693_需求文档 - 一局对接链数优化V0.1.docx
2025-07-30 19:31:56 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:31:56 - api_server - INFO - Word文档已成功转换为Markdown格式，长度: 2547 字符
2025-07-30 19:31:56 - api_server - INFO - 提取的文本内容已准备完毕
2025-07-30 19:31:56 - api_server - INFO - 提取的文本内容已准备完毕
2025-07-30 19:31:56 - api_server - INFO - 转换后内容预览: 一局对接链数优化

需求文档

| 版本 | V0.1 |
| --- | --- |
| 撰写人 | 李威明 |
| 类型 | 系统对接 |
| 标签 | 链数、中建一局 |

中企云链（北京）金融信息服务有限公司

文档控制

需求方

| 日期 | 需求人 | 需求部门 | 说明 |
| --- | --- | --- | --- |
| 2025/4/30 | 徐艺 | 金融服务部 |  |

版本记录

| 日期 | 撰写人 | 版本 | 变更说明 |
| --- | --- | --- | --- |
| 2025/4/30 | 李威明 | V0.1 | 创建文档 |

目录

第1章 项目介绍	4

1.1 需求背景	4

1.2 建设目标及路线	4

第2章 整体说明	4

2.1 需求模型	4

2.2 功能结构图	4

2.3 信息结构图	4

2.4 项目范围	4

2.4.1 新增功能	4

2.4.2 调整功能	4

第3章 功能需求说明	4

3.1 调整说明	4

# 项目介绍

## 需求背景

- 一局对接链数的项目上线后，核心企业反馈，希望就已推送至平台的数据，在核心企业内部系统内修改部分信息（如额度信息）后，使用原业务编号再次推送至平台。就目前的接口校验逻辑，相同业务编号的业务数据不可重复推送。因而，需要结合核心企业需求，对接口的校验逻辑进行调整。

## 建设目标及路线

- 调整接口校验逻辑，兼容核心企业重推数据的场景。

# 整体说明

## 需求模型

## 功能结构图

## 信息结构图

## 项目范围

### 新增功能

### 调整功能

# 功能需求说明

## 接口校验规则调整

### 调整说明

本期对【确权业务申请】接口中关于bizSerialNo的校验规则进行调整，调整后的校验规则为：

| 序号 | 接口名称 | 隶属服务 | 校验点 | 逻辑 | 错误提示 |
| --- | --- | --- | --- | --- | --- |
| 1 | 确权业务申请 | zqyl-data-open | 入参校验 | bizSerialNo不可与已成功推送的非“已作废”、“已删除”状态的链数业务数据对应的bizSerialNo成功记录重复 | bizSerialNo已存在，请先登录平台进行作废/删除。 |

## 链数额度功能调整

### 调整说明

本期，对原“链数额度”功能做如下调整：

- 功能名称由“链数额度”变更为“额度管理”；

- 页面右上方新增“组织单元额度”按钮，当且仅当当前登录企业为多组织企业时展示该按钮。用户点击“组织单元额度”按钮，则跳转至“组织单元额度”列表页。

- 列表新增字段“额度类型”，置于“额度名称”之后，若为链数额度则取值为“链数额度”。

![图片2](http://localhost:8082/uploads/temp/766532ce-cdc9-4035-8d2c-e04df211d693_img_20250730_193156_1.png)

## 新增组织单元额度功能

### 调整说明

本期在核心企业侧链数额度功能下，新增“组织单元额度”列表页。支持用户查询当前登录企业下的具体组织单元的链数额度、云信额度明细。

具体如下：

- 交互说明：

![图片1](http://localhost:8082/uploads/temp/766532ce-cdc9-4035-8d2c-e04df211d693_img_20250730_193156_0.png)

（页面入口：用户点击“额度管理”列表页右上角的“组织单元额度”按钮，跳转至该页面。）

- 返回：用户点击返回，返回至“额度管理”列表页。

- 导出：点击导出，将列表中用户筛选后的数据以xls文件格式导出至本地。

- 列表筛选：用户确定筛选条件后，点击查询按钮，按照用户确定的筛选条件对列表进行筛选；点击重置，列表恢复至未筛选状态。

- 功能说明：

- 列表需展示分配至当前登录企业下所有组织单元的链数额度和云信额度明细。页面载入时，默认展示分配至各组织单元的链数额度明细；若用户将额度类型切换为“云信额度”，则需要展示分配至各组织单元的云信额度明细；若用户将额度类型切换为“全部”，则需要展示分配至各组织单元的链数和云信额度明细。

- 字段说明：

- 筛选字段：

| 序号 | 字段名 | 类型格式 | 长度 | 默认值 | 必填 | 规则 |
| --- | --- | --- | --- | --- | --- | --- |
| 1 | 组织单元名称 | 文本输入框 | - | - | - | 模糊搜索 |
| 2 | 额度名称 | 文本输入框 | - | - | - | 模糊搜索 |
| 3 | 额度类型 | 下拉列表 | - | 链数额度 | - | 下拉选项：链数额度、云信额度、全部 |

- 汇总字段：

| 序号 | 字段名 | 类型格式 | 规则 |
| --- | --- | --- | --- |
| 1 | 总额度（元） | 数值 | 满足筛选条件的列表数据的“已分配额度（元）”之和 |
| 2 | 已用额度（元） | 数值 | 满足筛选条件的列表数据的“已用额度（元）”之和 |
| 3 | 可用额度（元） | 数值 | 满足筛选条件的列表数据的“可用额度（元）”之和 |

- 备注：筛选条件更新后，汇总值需要同步更新计算。

- 列表字段：

| 序号 | 字段名 | 类型格式 | 规则 |
| --- | --- | --- | --- |
| 1 | 组织单元名称 | 字符串 |  |
| 2 | 额度名称 | 字符串 |  |
| 3 | 额度类型 | 字符串 |  |
| 4 | 已分配额度（元） | 数值 |  |
| 5 | 已用额度（元） | 数值 |  |
| 6 | 可用额度（元） | 数值 |  |

- 备注：列表默认按照组织单元名称为主要关键字、额度类型为次要关键字降序排列。
2025-07-30 19:31:56 - api_server - INFO - 提取的文本内容已准备完毕
2025-07-30 19:31:56 - api_server - INFO - 转换后内容预览: 一局对接链数优化

需求文档

| 版本 | V0.1 |
| --- | --- |
| 撰写人 | 李威明 |
| 类型 | 系统对接 |
| 标签 | 链数、中建一局 |

中企云链（北京）金融信息服务有限公司

文档控制

需求方

| 日期 | 需求人 | 需求部门 | 说明 |
| --- | --- | --- | --- |
| 2025/4/30 | 徐艺 | 金融服务部 |  |

版本记录

| 日期 | 撰写人 | 版本 | 变更说明 |
| --- | --- | --- | --- |
| 2025/4/30 | 李威明 | V0.1 | 创建文档 |

目录

第1章 项目介绍	4

1.1 需求背景	4

1.2 建设目标及路线	4

第2章 整体说明	4

2.1 需求模型	4

2.2 功能结构图	4

2.3 信息结构图	4

2.4 项目范围	4

2.4.1 新增功能	4

2.4.2 调整功能	4

第3章 功能需求说明	4

3.1 调整说明	4

# 项目介绍

## 需求背景

- 一局对接链数的项目上线后，核心企业反馈，希望就已推送至平台的数据，在核心企业内部系统内修改部分信息（如额度信息）后，使用原业务编号再次推送至平台。就目前的接口校验逻辑，相同业务编号的业务数据不可重复推送。因而，需要结合核心企业需求，对接口的校验逻辑进行调整。

## 建设目标及路线

- 调整接口校验逻辑，兼容核心企业重推数据的场景。

# 整体说明

## 需求模型

## 功能结构图

## 信息结构图

## 项目范围

### 新增功能

### 调整功能

# 功能需求说明

## 接口校验规则调整

### 调整说明

本期对【确权业务申请】接口中关于bizSerialNo的校验规则进行调整，调整后的校验规则为：

| 序号 | 接口名称 | 隶属服务 | 校验点 | 逻辑 | 错误提示 |
| --- | --- | --- | --- | --- | --- |
| 1 | 确权业务申请 | zqyl-data-open | 入参校验 | bizSerialNo不可与已成功推送的非“已作废”、“已删除”状态的链数业务数据对应的bizSerialNo成功记录重复 | bizSerialNo已存在，请先登录平台进行作废/删除。 |

## 链数额度功能调整

### 调整说明

本期，对原“链数额度”功能做如下调整：

- 功能名称由“链数额度”变更为“额度管理”；

- 页面右上方新增“组织单元额度”按钮，当且仅当当前登录企业为多组织企业时展示该按钮。用户点击“组织单元额度”按钮，则跳转至“组织单元额度”列表页。

- 列表新增字段“额度类型”，置于“额度名称”之后，若为链数额度则取值为“链数额度”。

![图片2](http://localhost:8082/uploads/temp/766532ce-cdc9-4035-8d2c-e04df211d693_img_20250730_193156_1.png)

## 新增组织单元额度功能

### 调整说明

本期在核心企业侧链数额度功能下，新增“组织单元额度”列表页。支持用户查询当前登录企业下的具体组织单元的链数额度、云信额度明细。

具体如下：

- 交互说明：

![图片1](http://localhost:8082/uploads/temp/766532ce-cdc9-4035-8d2c-e04df211d693_img_20250730_193156_0.png)

（页面入口：用户点击“额度管理”列表页右上角的“组织单元额度”按钮，跳转至该页面。）

- 返回：用户点击返回，返回至“额度管理”列表页。

- 导出：点击导出，将列表中用户筛选后的数据以xls文件格式导出至本地。

- 列表筛选：用户确定筛选条件后，点击查询按钮，按照用户确定的筛选条件对列表进行筛选；点击重置，列表恢复至未筛选状态。

- 功能说明：

- 列表需展示分配至当前登录企业下所有组织单元的链数额度和云信额度明细。页面载入时，默认展示分配至各组织单元的链数额度明细；若用户将额度类型切换为“云信额度”，则需要展示分配至各组织单元的云信额度明细；若用户将额度类型切换为“全部”，则需要展示分配至各组织单元的链数和云信额度明细。

- 字段说明：

- 筛选字段：

| 序号 | 字段名 | 类型格式 | 长度 | 默认值 | 必填 | 规则 |
| --- | --- | --- | --- | --- | --- | --- |
| 1 | 组织单元名称 | 文本输入框 | - | - | - | 模糊搜索 |
| 2 | 额度名称 | 文本输入框 | - | - | - | 模糊搜索 |
| 3 | 额度类型 | 下拉列表 | - | 链数额度 | - | 下拉选项：链数额度、云信额度、全部 |

- 汇总字段：

| 序号 | 字段名 | 类型格式 | 规则 |
| --- | --- | --- | --- |
| 1 | 总额度（元） | 数值 | 满足筛选条件的列表数据的“已分配额度（元）”之和 |
| 2 | 已用额度（元） | 数值 | 满足筛选条件的列表数据的“已用额度（元）”之和 |
| 3 | 可用额度（元） | 数值 | 满足筛选条件的列表数据的“可用额度（元）”之和 |

- 备注：筛选条件更新后，汇总值需要同步更新计算。

- 列表字段：

| 序号 | 字段名 | 类型格式 | 规则 |
| --- | --- | --- | --- |
| 1 | 组织单元名称 | 字符串 |  |
| 2 | 额度名称 | 字符串 |  |
| 3 | 额度类型 | 字符串 |  |
| 4 | 已分配额度（元） | 数值 |  |
| 5 | 已用额度（元） | 数值 |  |
| 6 | 可用额度（元） | 数值 |  |

- 备注：列表默认按照组织单元名称为主要关键字、额度类型为次要关键字降序排列。
2025-07-30 19:31:56 - api_server - INFO - 任务 766532ce-cdc9-4035-8d2c-e04df211d693 进度更新: 40% - 使用分析服务解析文档
2025-07-30 19:31:58 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:00 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:02 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:04 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:06 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:08 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:10 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:12 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:14 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:16 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:18 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:19 - api_server - INFO - 任务 766532ce-cdc9-4035-8d2c-e04df211d693 进度更新: 100% - 文档解析完成
2025-07-30 19:32:19 - api_server - INFO - ✅ 文件解析完成: 766532ce-cdc9-4035-8d2c-e04df211d693
2025-07-30 19:32:19 - api_server - INFO - 任务 766532ce-cdc9-4035-8d2c-e04df211d693 进度更新: 40% - 开始内容分析
2025-07-30 19:32:19 - api_server - INFO - 🔍 开始内容分析任务: 766532ce-cdc9-4035-8d2c-e04df211d693
2025-07-30 19:32:19 - api_server - INFO - 📊 任务当前状态: content_analyzing
2025-07-30 19:32:19 - api_server - INFO - 📊 任务当前进度: 40%
2025-07-30 19:32:19 - api_server - INFO - 📊 解析结果存在: True
2025-07-30 19:32:19 - api_server - INFO - 📊 分析服务管理器可用: True
2025-07-30 19:32:19 - api_server - INFO - 任务 766532ce-cdc9-4035-8d2c-e04df211d693 进度更新: 10% - 开始内容分析
2025-07-30 19:32:19 - api_server - INFO - ✅ 任务状态已更新为: content_analyzing
2025-07-30 19:32:19 - api_server - INFO - 从文件路径读取: /Users/renyu/Documents/ai_project/document_analyzer/uploads/temp/766532ce-cdc9-4035-8d2c-e04df211d693_需求文档 - 一局对接链数优化V0.1.docx
2025-07-30 19:32:19 - api_server - INFO - 使用通用文件分析方法: 766532ce-cdc9-4035-8d2c-e04df211d693_需求文档 - 一局对接链数优化V0.1.docx
2025-07-30 19:32:19 - api_server - INFO - 检测到Word文档，使用Markdown转换: 766532ce-cdc9-4035-8d2c-e04df211d693_需求文档 - 一局对接链数优化V0.1.docx
2025-07-30 19:32:20 - api_server - INFO - Word文档已成功转换为Markdown格式，长度: 2547 字符
2025-07-30 19:32:20 - api_server - INFO - 提取的文本内容已准备完毕
2025-07-30 19:32:20 - api_server - INFO - 任务 766532ce-cdc9-4035-8d2c-e04df211d693 进度更新: 30% - 获取到上传文件
2025-07-30 19:32:20 - api_server - INFO - 📄 提取到文档内容，长度: 2547 字符
2025-07-30 19:32:20 - api_server - INFO - 任务 766532ce-cdc9-4035-8d2c-e04df211d693 进度更新: 35% - 内容分析管理器开始分析
2025-07-30 19:32:20 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:22 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:24 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:26 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:28 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:30 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:32 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:34 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:36 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:38 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:40 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:42 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:44 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:46 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:48 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:51 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:53 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:55 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:57 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:32:59 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:01 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:03 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:05 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:07 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:09 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:11 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:13 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:15 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:17 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:19 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:21 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:23 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:25 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:27 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:29 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:31 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:33 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:35 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:37 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:39 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:41 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:43 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:45 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:47 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:49 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:51 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:53 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:55 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:57 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:33:59 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:01 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:03 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:05 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:07 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:09 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:11 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:13 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:15 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:17 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:19 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:21 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:23 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:25 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:27 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:29 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:31 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:33 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:35 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:37 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:39 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:41 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:43 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:45 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:47 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:49 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:51 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:53 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:55 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:57 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:34:59 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:01 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:03 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:05 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:07 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:09 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:11 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:13 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:15 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:17 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:19 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:21 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:23 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:25 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:27 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:28 - api_server - INFO - 任务 766532ce-cdc9-4035-8d2c-e04df211d693 进度更新: 100% - 内容分析完成
2025-07-30 19:35:28 - api_server - INFO - ✅ 内容分析完成: 766532ce-cdc9-4035-8d2c-e04df211d693
2025-07-30 19:35:28 - api_server - INFO - 任务 766532ce-cdc9-4035-8d2c-e04df211d693 进度更新: 70% - 开始AI设计方案
2025-07-30 19:35:28 - api_server - INFO - 🤖 开始AI分析任务: 766532ce-cdc9-4035-8d2c-e04df211d693
2025-07-30 19:35:28 - api_server - INFO - 任务 766532ce-cdc9-4035-8d2c-e04df211d693 进度更新: 10% - 开始AI设计方案
2025-07-30 19:35:28 - api_server - INFO - 任务 766532ce-cdc9-4035-8d2c-e04df211d693 进度更新: 30% - 使用分析服务进行AI分析
2025-07-30 19:35:30 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:32 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:34 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:36 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:38 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:40 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:42 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:44 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:46 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:48 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:50 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:52 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:54 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:56 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:35:58 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:00 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:02 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:04 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:06 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:08 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:10 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:12 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:14 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:16 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:18 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:20 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:22 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:24 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:26 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:28 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:30 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:32 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:34 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:36 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:38 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:40 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:42 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:44 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:46 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:48 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:50 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:52 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:54 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:56 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:36:58 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:00 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:02 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:04 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:06 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:08 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:10 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:12 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:14 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:16 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:18 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:20 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:22 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:24 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:26 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:28 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:30 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:32 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:34 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:36 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:38 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:40 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:42 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:44 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:46 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:48 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:50 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:52 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:54 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:56 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:37:58 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:38:00 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:38:03 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:38:05 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:38:07 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:38:09 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:38:11 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:38:13 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:38:15 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:38:17 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:38:19 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:38:21 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:38:23 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:38:25 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:38:27 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:38:29 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:38:31 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:38:33 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:38:35 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:38:37 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:38:39 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:38:41 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:38:43 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:38:45 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:38:47 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:38:49 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:38:50 - api_server - ERROR - 任务 766532ce-cdc9-4035-8d2c-e04df211d693 AI分析失败: object dict can't be used in 'await' expression
2025-07-30 19:38:50 - api_server - ERROR - ❌ 任务 766532ce-cdc9-4035-8d2c-e04df211d693 AI分析失败: object dict can't be used in 'await' expression
2025-07-30 19:38:50 - api_server - INFO - 任务 766532ce-cdc9-4035-8d2c-e04df211d693 进度更新: 30% - AI分析失败: object dict can't be used in 'await' expression
2025-07-30 19:38:50 - api_server - ERROR - AI分析失败: 766532ce-cdc9-4035-8d2c-e04df211d693, 当前状态: failed, 错误信息: AI分析失败: object dict can't be used in 'await' expression
2025-07-30 19:38:50 - api_server - INFO - 检测到form_data已生成，继续完成流程: 766532ce-cdc9-4035-8d2c-e04df211d693
2025-07-30 19:38:50 - api_server - INFO - 任务 766532ce-cdc9-4035-8d2c-e04df211d693 进度更新: 100% - 完整分析流程完成
2025-07-30 19:38:50 - api_server - INFO - 完整分析流程成功完成: 766532ce-cdc9-4035-8d2c-e04df211d693
2025-07-30 19:38:50 - api_server - INFO - 🎉 完整分析流程完成: 766532ce-cdc9-4035-8d2c-e04df211d693
2025-07-30 19:38:51 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 19:38:51 - api_server - INFO - 收到设计方案表单数据获取请求: 任务ID=766532ce-cdc9-4035-8d2c-e04df211d693
2025-07-30 19:38:51 - api_server - INFO - 设计方案表单数据获取成功: 任务ID=766532ce-cdc9-4035-8d2c-e04df211d693, 表单字段数=11
2025-07-30 19:38:51 - api_server - INFO - ✅ GET get_design_form_data [200] (0.00s)
2025-07-30 19:38:51 - api_server - INFO - 🔍 数据类型诊断 - parsing_result: <class 'dict'>
2025-07-30 19:38:51 - api_server - INFO - 🔍 数据类型诊断 - content_analysis: <class 'dict'>
2025-07-30 19:38:51 - api_server - INFO - 🔍 数据类型诊断 - ai_analysis: <class 'dict'>
2025-07-30 19:38:51 - api_server - INFO - ✅ GET get_analysis_result [200] (0.00s)
2025-07-30 19:51:31 - api_server - INFO - 从配置文件读取火山引擎配置: {'api_key': '7fcb3541-9363-4bfa-90aa-19e9f691bc25', 'endpoint': 'https://ark.cn-beijing.volces.com/api/v3', 'max_tokens': 16000, 'model': 'ep-20250605091804-wmw6w', 'temperature': 0.7}
2025-07-30 19:51:31 - api_server - INFO - 火山引擎客户端初始化成功
2025-07-30 19:51:31 - api_server - INFO - Weaviate配置: http://localhost:8080
2025-07-30 19:51:43 - api_server - INFO - 分析服务管理器初始化成功
2025-07-30 19:51:43 - api_server - INFO - 分析服务管理器已集成到API服务器
2025-07-30 19:51:43 - api_server - INFO - 增强分析器初始化成功
2025-07-30 19:54:49 - api_server - INFO - 从配置文件读取火山引擎配置: {'api_key': '7fcb3541-9363-4bfa-90aa-19e9f691bc25', 'endpoint': 'https://ark.cn-beijing.volces.com/api/v3', 'max_tokens': 16000, 'model': 'ep-20250605091804-wmw6w', 'temperature': 0.7}
2025-07-30 19:54:49 - api_server - INFO - 火山引擎客户端初始化成功
2025-07-30 19:54:49 - api_server - INFO - Weaviate配置: http://localhost:8080
2025-07-30 19:55:00 - api_server - INFO - 分析服务管理器初始化成功
2025-07-30 19:55:00 - api_server - INFO - 分析服务管理器已集成到API服务器
2025-07-30 19:55:00 - api_server - INFO - 增强分析器初始化成功
2025-07-30 20:04:19 - api_server - INFO - 从配置文件读取火山引擎配置: {'api_key': '7fcb3541-9363-4bfa-90aa-19e9f691bc25', 'endpoint': 'https://ark.cn-beijing.volces.com/api/v3', 'max_tokens': 16000, 'model': 'ep-20250605091804-wmw6w', 'temperature': 0.7}
2025-07-30 20:04:19 - api_server - INFO - 火山引擎客户端初始化成功
2025-07-30 20:04:19 - api_server - INFO - Weaviate配置: http://localhost:8080
2025-07-30 20:04:30 - api_server - INFO - 分析服务管理器初始化成功
2025-07-30 20:04:30 - api_server - INFO - 分析服务管理器已集成到API服务器
2025-07-30 20:04:30 - api_server - INFO - 增强分析器初始化成功
2025-07-30 20:04:40 - api_server - INFO - 从配置文件读取火山引擎配置: {'api_key': '7fcb3541-9363-4bfa-90aa-19e9f691bc25', 'endpoint': 'https://ark.cn-beijing.volces.com/api/v3', 'max_tokens': 16000, 'model': 'ep-20250605091804-wmw6w', 'temperature': 0.7}
2025-07-30 20:04:40 - api_server - INFO - 火山引擎客户端初始化成功
2025-07-30 20:04:40 - api_server - INFO - Weaviate配置: http://localhost:8080
2025-07-30 20:04:51 - api_server - INFO - 分析服务管理器初始化成功
2025-07-30 20:04:51 - api_server - INFO - 分析服务管理器已集成到API服务器
2025-07-30 20:04:51 - api_server - INFO - 增强分析器初始化成功
2025-07-30 20:04:51 - api_server - INFO - file_info包含content字段，长度: 1132360
2025-07-30 20:04:51 - api_server - INFO - base64解码成功，file_content类型: <class 'bytes'>, 大小: 849268 bytes
2025-07-30 20:04:51 - api_server - INFO - 任务 088a00a0-fea6-417b-a475-6c8160587be0 进度更新: 0% - 分析流程启动中
2025-07-30 20:04:51 - api_server - INFO - 开始完整分析流程: 088a00a0-fea6-417b-a475-6c8160587be0
2025-07-30 20:04:51 - api_server - INFO - 🚀 完整分析流程启动: 088a00a0-fea6-417b-a475-6c8160587be0
2025-07-30 20:04:51 - api_server - INFO - V2 完整分析启动成功: 需求文档 - 一局对接链数优化V0.1.docx, 任务ID: 088a00a0-fea6-417b-a475-6c8160587be0, 大小: 849268 bytes
2025-07-30 20:04:51 - api_server - INFO - 🚀 V2 完整分析启动: 需求文档 - 一局对接链数优化V0.1.docx, 任务ID: 088a00a0-fea6-417b-a475-6c8160587be0
2025-07-30 20:04:51 - api_server - INFO - ✅ POST start_analysis_v2 [200] (0.01s)
2025-07-30 20:04:51 - api_server - INFO - 任务 088a00a0-fea6-417b-a475-6c8160587be0 进度更新: 10% - 开始文档解析
2025-07-30 20:04:51 - api_server - INFO - 任务 088a00a0-fea6-417b-a475-6c8160587be0 进度更新: 10% - 开始解析文件
2025-07-30 20:04:51 - api_server - INFO - 从文件路径读取: /Users/renyu/Documents/ai_project/document_analyzer/uploads/temp/088a00a0-fea6-417b-a475-6c8160587be0_需求文档 - 一局对接链数优化V0.1.docx
2025-07-30 20:04:51 - api_server - INFO - 使用通用文件分析方法: 088a00a0-fea6-417b-a475-6c8160587be0_需求文档 - 一局对接链数优化V0.1.docx
2025-07-30 20:04:51 - api_server - INFO - 检测到Word文档，使用Markdown转换: 088a00a0-fea6-417b-a475-6c8160587be0_需求文档 - 一局对接链数优化V0.1.docx
2025-07-30 20:04:51 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:04:51 - api_server - INFO - Word文档已成功转换为Markdown格式，长度: 2547 字符
2025-07-30 20:04:51 - api_server - INFO - 提取的文本内容已准备完毕
2025-07-30 20:04:51 - api_server - INFO - 提取的文本内容已准备完毕
2025-07-30 20:04:51 - api_server - INFO - 转换后内容预览: 一局对接链数优化

需求文档

| 版本 | V0.1 |
| --- | --- |
| 撰写人 | 李威明 |
| 类型 | 系统对接 |
| 标签 | 链数、中建一局 |

中企云链（北京）金融信息服务有限公司

文档控制

需求方

| 日期 | 需求人 | 需求部门 | 说明 |
| --- | --- | --- | --- |
| 2025/4/30 | 徐艺 | 金融服务部 |  |

版本记录

| 日期 | 撰写人 | 版本 | 变更说明 |
| --- | --- | --- | --- |
| 2025/4/30 | 李威明 | V0.1 | 创建文档 |

目录

第1章 项目介绍	4

1.1 需求背景	4

1.2 建设目标及路线	4

第2章 整体说明	4

2.1 需求模型	4

2.2 功能结构图	4

2.3 信息结构图	4

2.4 项目范围	4

2.4.1 新增功能	4

2.4.2 调整功能	4

第3章 功能需求说明	4

3.1 调整说明	4

# 项目介绍

## 需求背景

- 一局对接链数的项目上线后，核心企业反馈，希望就已推送至平台的数据，在核心企业内部系统内修改部分信息（如额度信息）后，使用原业务编号再次推送至平台。就目前的接口校验逻辑，相同业务编号的业务数据不可重复推送。因而，需要结合核心企业需求，对接口的校验逻辑进行调整。

## 建设目标及路线

- 调整接口校验逻辑，兼容核心企业重推数据的场景。

# 整体说明

## 需求模型

## 功能结构图

## 信息结构图

## 项目范围

### 新增功能

### 调整功能

# 功能需求说明

## 接口校验规则调整

### 调整说明

本期对【确权业务申请】接口中关于bizSerialNo的校验规则进行调整，调整后的校验规则为：

| 序号 | 接口名称 | 隶属服务 | 校验点 | 逻辑 | 错误提示 |
| --- | --- | --- | --- | --- | --- |
| 1 | 确权业务申请 | zqyl-data-open | 入参校验 | bizSerialNo不可与已成功推送的非“已作废”、“已删除”状态的链数业务数据对应的bizSerialNo成功记录重复 | bizSerialNo已存在，请先登录平台进行作废/删除。 |

## 链数额度功能调整

### 调整说明

本期，对原“链数额度”功能做如下调整：

- 功能名称由“链数额度”变更为“额度管理”；

- 页面右上方新增“组织单元额度”按钮，当且仅当当前登录企业为多组织企业时展示该按钮。用户点击“组织单元额度”按钮，则跳转至“组织单元额度”列表页。

- 列表新增字段“额度类型”，置于“额度名称”之后，若为链数额度则取值为“链数额度”。

![图片2](http://localhost:8082/uploads/temp/088a00a0-fea6-417b-a475-6c8160587be0_img_20250730_200451_1.png)

## 新增组织单元额度功能

### 调整说明

本期在核心企业侧链数额度功能下，新增“组织单元额度”列表页。支持用户查询当前登录企业下的具体组织单元的链数额度、云信额度明细。

具体如下：

- 交互说明：

![图片1](http://localhost:8082/uploads/temp/088a00a0-fea6-417b-a475-6c8160587be0_img_20250730_200451_0.png)

（页面入口：用户点击“额度管理”列表页右上角的“组织单元额度”按钮，跳转至该页面。）

- 返回：用户点击返回，返回至“额度管理”列表页。

- 导出：点击导出，将列表中用户筛选后的数据以xls文件格式导出至本地。

- 列表筛选：用户确定筛选条件后，点击查询按钮，按照用户确定的筛选条件对列表进行筛选；点击重置，列表恢复至未筛选状态。

- 功能说明：

- 列表需展示分配至当前登录企业下所有组织单元的链数额度和云信额度明细。页面载入时，默认展示分配至各组织单元的链数额度明细；若用户将额度类型切换为“云信额度”，则需要展示分配至各组织单元的云信额度明细；若用户将额度类型切换为“全部”，则需要展示分配至各组织单元的链数和云信额度明细。

- 字段说明：

- 筛选字段：

| 序号 | 字段名 | 类型格式 | 长度 | 默认值 | 必填 | 规则 |
| --- | --- | --- | --- | --- | --- | --- |
| 1 | 组织单元名称 | 文本输入框 | - | - | - | 模糊搜索 |
| 2 | 额度名称 | 文本输入框 | - | - | - | 模糊搜索 |
| 3 | 额度类型 | 下拉列表 | - | 链数额度 | - | 下拉选项：链数额度、云信额度、全部 |

- 汇总字段：

| 序号 | 字段名 | 类型格式 | 规则 |
| --- | --- | --- | --- |
| 1 | 总额度（元） | 数值 | 满足筛选条件的列表数据的“已分配额度（元）”之和 |
| 2 | 已用额度（元） | 数值 | 满足筛选条件的列表数据的“已用额度（元）”之和 |
| 3 | 可用额度（元） | 数值 | 满足筛选条件的列表数据的“可用额度（元）”之和 |

- 备注：筛选条件更新后，汇总值需要同步更新计算。

- 列表字段：

| 序号 | 字段名 | 类型格式 | 规则 |
| --- | --- | --- | --- |
| 1 | 组织单元名称 | 字符串 |  |
| 2 | 额度名称 | 字符串 |  |
| 3 | 额度类型 | 字符串 |  |
| 4 | 已分配额度（元） | 数值 |  |
| 5 | 已用额度（元） | 数值 |  |
| 6 | 可用额度（元） | 数值 |  |

- 备注：列表默认按照组织单元名称为主要关键字、额度类型为次要关键字降序排列。
2025-07-30 20:04:51 - api_server - INFO - 提取的文本内容已准备完毕
2025-07-30 20:04:51 - api_server - INFO - 转换后内容预览: 一局对接链数优化

需求文档

| 版本 | V0.1 |
| --- | --- |
| 撰写人 | 李威明 |
| 类型 | 系统对接 |
| 标签 | 链数、中建一局 |

中企云链（北京）金融信息服务有限公司

文档控制

需求方

| 日期 | 需求人 | 需求部门 | 说明 |
| --- | --- | --- | --- |
| 2025/4/30 | 徐艺 | 金融服务部 |  |

版本记录

| 日期 | 撰写人 | 版本 | 变更说明 |
| --- | --- | --- | --- |
| 2025/4/30 | 李威明 | V0.1 | 创建文档 |

目录

第1章 项目介绍	4

1.1 需求背景	4

1.2 建设目标及路线	4

第2章 整体说明	4

2.1 需求模型	4

2.2 功能结构图	4

2.3 信息结构图	4

2.4 项目范围	4

2.4.1 新增功能	4

2.4.2 调整功能	4

第3章 功能需求说明	4

3.1 调整说明	4

# 项目介绍

## 需求背景

- 一局对接链数的项目上线后，核心企业反馈，希望就已推送至平台的数据，在核心企业内部系统内修改部分信息（如额度信息）后，使用原业务编号再次推送至平台。就目前的接口校验逻辑，相同业务编号的业务数据不可重复推送。因而，需要结合核心企业需求，对接口的校验逻辑进行调整。

## 建设目标及路线

- 调整接口校验逻辑，兼容核心企业重推数据的场景。

# 整体说明

## 需求模型

## 功能结构图

## 信息结构图

## 项目范围

### 新增功能

### 调整功能

# 功能需求说明

## 接口校验规则调整

### 调整说明

本期对【确权业务申请】接口中关于bizSerialNo的校验规则进行调整，调整后的校验规则为：

| 序号 | 接口名称 | 隶属服务 | 校验点 | 逻辑 | 错误提示 |
| --- | --- | --- | --- | --- | --- |
| 1 | 确权业务申请 | zqyl-data-open | 入参校验 | bizSerialNo不可与已成功推送的非“已作废”、“已删除”状态的链数业务数据对应的bizSerialNo成功记录重复 | bizSerialNo已存在，请先登录平台进行作废/删除。 |

## 链数额度功能调整

### 调整说明

本期，对原“链数额度”功能做如下调整：

- 功能名称由“链数额度”变更为“额度管理”；

- 页面右上方新增“组织单元额度”按钮，当且仅当当前登录企业为多组织企业时展示该按钮。用户点击“组织单元额度”按钮，则跳转至“组织单元额度”列表页。

- 列表新增字段“额度类型”，置于“额度名称”之后，若为链数额度则取值为“链数额度”。

![图片2](http://localhost:8082/uploads/temp/088a00a0-fea6-417b-a475-6c8160587be0_img_20250730_200451_1.png)

## 新增组织单元额度功能

### 调整说明

本期在核心企业侧链数额度功能下，新增“组织单元额度”列表页。支持用户查询当前登录企业下的具体组织单元的链数额度、云信额度明细。

具体如下：

- 交互说明：

![图片1](http://localhost:8082/uploads/temp/088a00a0-fea6-417b-a475-6c8160587be0_img_20250730_200451_0.png)

（页面入口：用户点击“额度管理”列表页右上角的“组织单元额度”按钮，跳转至该页面。）

- 返回：用户点击返回，返回至“额度管理”列表页。

- 导出：点击导出，将列表中用户筛选后的数据以xls文件格式导出至本地。

- 列表筛选：用户确定筛选条件后，点击查询按钮，按照用户确定的筛选条件对列表进行筛选；点击重置，列表恢复至未筛选状态。

- 功能说明：

- 列表需展示分配至当前登录企业下所有组织单元的链数额度和云信额度明细。页面载入时，默认展示分配至各组织单元的链数额度明细；若用户将额度类型切换为“云信额度”，则需要展示分配至各组织单元的云信额度明细；若用户将额度类型切换为“全部”，则需要展示分配至各组织单元的链数和云信额度明细。

- 字段说明：

- 筛选字段：

| 序号 | 字段名 | 类型格式 | 长度 | 默认值 | 必填 | 规则 |
| --- | --- | --- | --- | --- | --- | --- |
| 1 | 组织单元名称 | 文本输入框 | - | - | - | 模糊搜索 |
| 2 | 额度名称 | 文本输入框 | - | - | - | 模糊搜索 |
| 3 | 额度类型 | 下拉列表 | - | 链数额度 | - | 下拉选项：链数额度、云信额度、全部 |

- 汇总字段：

| 序号 | 字段名 | 类型格式 | 规则 |
| --- | --- | --- | --- |
| 1 | 总额度（元） | 数值 | 满足筛选条件的列表数据的“已分配额度（元）”之和 |
| 2 | 已用额度（元） | 数值 | 满足筛选条件的列表数据的“已用额度（元）”之和 |
| 3 | 可用额度（元） | 数值 | 满足筛选条件的列表数据的“可用额度（元）”之和 |

- 备注：筛选条件更新后，汇总值需要同步更新计算。

- 列表字段：

| 序号 | 字段名 | 类型格式 | 规则 |
| --- | --- | --- | --- |
| 1 | 组织单元名称 | 字符串 |  |
| 2 | 额度名称 | 字符串 |  |
| 3 | 额度类型 | 字符串 |  |
| 4 | 已分配额度（元） | 数值 |  |
| 5 | 已用额度（元） | 数值 |  |
| 6 | 可用额度（元） | 数值 |  |

- 备注：列表默认按照组织单元名称为主要关键字、额度类型为次要关键字降序排列。
2025-07-30 20:04:51 - api_server - INFO - 任务 088a00a0-fea6-417b-a475-6c8160587be0 进度更新: 40% - 使用分析服务解析文档
2025-07-30 20:04:53 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:04:55 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:04:57 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:04:59 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:01 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:03 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:05 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:07 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:09 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:11 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:13 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:15 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:17 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:17 - api_server - INFO - 任务 088a00a0-fea6-417b-a475-6c8160587be0 进度更新: 100% - 文档解析完成
2025-07-30 20:05:17 - api_server - INFO - ✅ 文件解析完成: 088a00a0-fea6-417b-a475-6c8160587be0
2025-07-30 20:05:17 - api_server - INFO - 任务 088a00a0-fea6-417b-a475-6c8160587be0 进度更新: 40% - 开始内容分析
2025-07-30 20:05:17 - api_server - INFO - 🔍 开始内容分析任务: 088a00a0-fea6-417b-a475-6c8160587be0
2025-07-30 20:05:17 - api_server - INFO - 📊 任务当前状态: content_analyzing
2025-07-30 20:05:17 - api_server - INFO - 📊 任务当前进度: 40%
2025-07-30 20:05:17 - api_server - INFO - 📊 解析结果存在: True
2025-07-30 20:05:17 - api_server - INFO - 📊 分析服务管理器可用: True
2025-07-30 20:05:17 - api_server - INFO - 任务 088a00a0-fea6-417b-a475-6c8160587be0 进度更新: 10% - 开始内容分析
2025-07-30 20:05:17 - api_server - INFO - ✅ 任务状态已更新为: content_analyzing
2025-07-30 20:05:17 - api_server - INFO - 从文件路径读取: /Users/renyu/Documents/ai_project/document_analyzer/uploads/temp/088a00a0-fea6-417b-a475-6c8160587be0_需求文档 - 一局对接链数优化V0.1.docx
2025-07-30 20:05:17 - api_server - INFO - 使用通用文件分析方法: 088a00a0-fea6-417b-a475-6c8160587be0_需求文档 - 一局对接链数优化V0.1.docx
2025-07-30 20:05:17 - api_server - INFO - 检测到Word文档，使用Markdown转换: 088a00a0-fea6-417b-a475-6c8160587be0_需求文档 - 一局对接链数优化V0.1.docx
2025-07-30 20:05:17 - api_server - INFO - Word文档已成功转换为Markdown格式，长度: 2547 字符
2025-07-30 20:05:17 - api_server - INFO - 提取的文本内容已准备完毕
2025-07-30 20:05:17 - api_server - INFO - 任务 088a00a0-fea6-417b-a475-6c8160587be0 进度更新: 30% - 获取到上传文件
2025-07-30 20:05:17 - api_server - INFO - 📄 提取到文档内容，长度: 2547 字符
2025-07-30 20:05:17 - api_server - INFO - 任务 088a00a0-fea6-417b-a475-6c8160587be0 进度更新: 35% - 内容分析管理器开始分析
2025-07-30 20:05:19 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:21 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:23 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:25 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:27 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:29 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:31 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:33 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:35 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:37 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:39 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:41 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:43 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:45 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:47 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:49 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:51 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:53 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:55 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:57 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:05:59 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:01 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:03 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:05 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:08 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:10 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:12 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:14 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:16 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:18 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:20 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:22 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:24 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:26 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:28 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:30 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:32 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:34 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:36 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:38 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:40 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:42 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:44 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:46 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:48 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:50 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:52 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:54 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:56 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:06:58 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:00 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:02 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:04 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:06 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:08 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:10 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:12 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:14 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:16 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:18 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:20 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:22 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:24 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:26 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:28 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:30 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:32 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:34 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:36 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:38 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:40 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:42 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:44 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:46 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:48 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:50 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:52 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:54 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:56 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:07:58 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:00 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:02 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:04 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:06 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:08 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:10 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:12 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:14 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:16 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:18 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:20 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:22 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:24 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:26 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:28 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:30 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:32 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:34 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:36 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:38 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:40 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:42 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:44 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:47 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:49 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:51 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:53 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:55 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:57 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:08:59 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:01 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:03 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:05 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:07 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:09 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:11 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:13 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:15 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:17 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:19 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:21 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:22 - api_server - INFO - 任务 088a00a0-fea6-417b-a475-6c8160587be0 进度更新: 100% - 内容分析完成
2025-07-30 20:09:22 - api_server - INFO - ✅ 内容分析完成: 088a00a0-fea6-417b-a475-6c8160587be0
2025-07-30 20:09:22 - api_server - INFO - 任务 088a00a0-fea6-417b-a475-6c8160587be0 进度更新: 70% - 开始AI设计方案
2025-07-30 20:09:22 - api_server - INFO - 🤖 开始AI分析任务: 088a00a0-fea6-417b-a475-6c8160587be0
2025-07-30 20:09:22 - api_server - INFO - 任务 088a00a0-fea6-417b-a475-6c8160587be0 进度更新: 10% - 开始AI设计方案
2025-07-30 20:09:22 - api_server - INFO - 任务 088a00a0-fea6-417b-a475-6c8160587be0 进度更新: 30% - 使用分析服务进行AI分析
2025-07-30 20:09:23 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:25 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:27 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:29 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:31 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:33 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:35 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:37 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:39 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:41 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:43 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:45 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:47 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:49 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:51 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:53 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:55 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:57 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:09:59 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:10:01 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:10:03 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:10:05 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:10:07 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:10:09 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:10:11 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:10:13 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:10:15 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:10:17 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:10:19 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:10:21 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:10:23 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:10:25 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:10:27 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:10:29 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:10:31 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:10:33 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:10:35 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:10:37 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:10:39 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:10:41 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:10:43 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:10:45 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:10:47 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:10:49 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:10:50 - api_server - ERROR - 任务 088a00a0-fea6-417b-a475-6c8160587be0 AI分析失败: object dict can't be used in 'await' expression
2025-07-30 20:10:50 - api_server - ERROR - ❌ 任务 088a00a0-fea6-417b-a475-6c8160587be0 AI分析失败: object dict can't be used in 'await' expression
2025-07-30 20:10:50 - api_server - INFO - 任务 088a00a0-fea6-417b-a475-6c8160587be0 进度更新: 30% - AI分析失败: object dict can't be used in 'await' expression
2025-07-30 20:10:50 - api_server - ERROR - AI分析失败: 088a00a0-fea6-417b-a475-6c8160587be0, 当前状态: failed, 错误信息: AI分析失败: object dict can't be used in 'await' expression
2025-07-30 20:10:50 - api_server - INFO - 检测到form_data已生成，继续完成流程: 088a00a0-fea6-417b-a475-6c8160587be0
2025-07-30 20:10:50 - api_server - INFO - 任务 088a00a0-fea6-417b-a475-6c8160587be0 进度更新: 100% - 完整分析流程完成
2025-07-30 20:10:50 - api_server - INFO - 完整分析流程成功完成: 088a00a0-fea6-417b-a475-6c8160587be0
2025-07-30 20:10:50 - api_server - INFO - 🎉 完整分析流程完成: 088a00a0-fea6-417b-a475-6c8160587be0
2025-07-30 20:10:51 - api_server - INFO - ✅ GET get_analysis_progress_v2 [200] (0.00s)
2025-07-30 20:10:51 - api_server - INFO - 收到设计方案表单数据获取请求: 任务ID=088a00a0-fea6-417b-a475-6c8160587be0
2025-07-30 20:10:51 - api_server - INFO - 设计方案表单数据获取成功: 任务ID=088a00a0-fea6-417b-a475-6c8160587be0, 表单字段数=11
2025-07-30 20:10:51 - api_server - INFO - ✅ GET get_design_form_data [200] (0.00s)
2025-07-30 20:10:51 - api_server - INFO - 🔍 数据类型诊断 - parsing_result: <class 'dict'>
2025-07-30 20:10:51 - api_server - INFO - 🔍 数据类型诊断 - content_analysis: <class 'dict'>
2025-07-30 20:10:51 - api_server - INFO - 🔍 数据类型诊断 - ai_analysis: <class 'dict'>
2025-07-30 20:10:51 - api_server - INFO - ✅ GET get_analysis_result [200] (0.00s)
