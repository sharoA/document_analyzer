# analyDesign æ¥å£å¿«é€Ÿå‚è€ƒè¡¨

## ğŸŒ HTTP API æ¥å£ (ç«¯å£ 8082)

| åºå· | æ–¹æ³• | è·¯å¾„ | åŠŸèƒ½ | çŠ¶æ€ |
|------|------|------|------|------|
| 1 | GET | `/` | æœåŠ¡é¦–é¡µä¿¡æ¯ | âœ… |
| 2 | GET | `/api/health` | å¥åº·æ£€æŸ¥ | âœ… |
| 3 | POST | `/api/chat` | èŠå¤©å¯¹è¯ | âœ… |
| 4 | GET | `/api/sessions` | è·å–æ‰€æœ‰ä¼šè¯ | âœ… |
| 5 | GET | `/api/sessions/{session_id}` | è·å–ç‰¹å®šä¼šè¯ | âœ… |
| 6 | DELETE | `/api/sessions/{session_id}` | åˆ é™¤ä¼šè¯ | âœ… |
| 7 | POST | `/api/file/upload` | æ–‡ä»¶ä¸Šä¼  | âœ… |
| 8 | GET | `/api/file/parsing/{task_id}` | è·å–è§£æçŠ¶æ€ | âœ… |
| 9 | POST | `/api/file/analyze/{task_id}` | å†…å®¹åˆ†æ | âœ… |
| 10 | POST | `/api/file/ai-analyze/{task_id}` | AIæ™ºèƒ½åˆ†æ | âœ… |
| 11 | GET | `/api/file/result/{task_id}` | è·å–å®Œæ•´ç»“æœ | âœ… |
| 12 | GET | `/api/file/list` | è·å–æ–‡ä»¶åˆ—è¡¨ | âœ… |
| 13 | DELETE | `/api/file/delete/{task_id}` | åˆ é™¤æ–‡ä»¶ | âœ… |

## ğŸ”Œ WebSocket äº‹ä»¶ (ç«¯å£ 8081)

| åºå· | äº‹ä»¶ç±»å‹ | äº‹ä»¶å | æ–¹å‘ | åŠŸèƒ½ | çŠ¶æ€ |
|------|----------|--------|------|------|------|
| 1 | è¿æ¥ | `connect` | å®¢æˆ·ç«¯â†’æœåŠ¡å™¨ | å»ºç«‹è¿æ¥ | âœ… |
| 2 | å“åº” | `connected` | æœåŠ¡å™¨â†’å®¢æˆ·ç«¯ | è¿æ¥æˆåŠŸç¡®è®¤ | âœ… |
| 3 | æ–­å¼€ | `disconnect` | å®¢æˆ·ç«¯â†’æœåŠ¡å™¨ | æ–­å¼€è¿æ¥ | âœ… |
| 4 | å¿ƒè·³ | `ping` | å®¢æˆ·ç«¯â†’æœåŠ¡å™¨ | å¿ƒè·³æ£€æµ‹ | âœ… |
| 5 | å¿ƒè·³ | `pong` | æœåŠ¡å™¨â†’å®¢æˆ·ç«¯ | å¿ƒè·³å“åº” | âœ… |
| 6 | èŠå¤© | `chat` | å®¢æˆ·ç«¯â†’æœåŠ¡å™¨ | å‘é€æ¶ˆæ¯ | âœ… |
| 7 | å¤„ç† | `chat_processing` | æœåŠ¡å™¨â†’å®¢æˆ·ç«¯ | å¤„ç†ä¸­çŠ¶æ€ | âœ… |
| 8 | å“åº” | `chat_response` | æœåŠ¡å™¨â†’å®¢æˆ·ç«¯ | AIå›å¤ | âœ… |
| 9 | è¿›åº¦ | `file_upload_progress` | å®¢æˆ·ç«¯â†’æœåŠ¡å™¨ | ä¸Šä¼ è¿›åº¦ | âœ… |
| 10 | æ›´æ–° | `file_progress_update` | æœåŠ¡å™¨â†’å®¢æˆ·ç«¯ | è¿›åº¦æ›´æ–° | âœ… |
| 11 | æŸ¥è¯¢ | `get_status` | å®¢æˆ·ç«¯â†’æœåŠ¡å™¨ | è·å–çŠ¶æ€ | âœ… |
| 12 | çŠ¶æ€ | `status_response` | æœåŠ¡å™¨â†’å®¢æˆ·ç«¯ | çŠ¶æ€å“åº” | âœ… |
| 13 | é”™è¯¯ | `error` | æœåŠ¡å™¨â†’å®¢æˆ·ç«¯ | é”™è¯¯é€šçŸ¥ | âœ… |

## ğŸš€ å¯åŠ¨å‘½ä»¤

| å¯åŠ¨æ–¹å¼ | å‘½ä»¤ | ç«¯å£ | è¯´æ˜ |
|----------|------|------|------|
| å®Œæ•´æœåŠ¡ | `python run.py --mode=full` | 8081+8082 | æ¨è |
| ä»…API | `python run.py --mode=api` | 8082 | HTTPæ¥å£ |
| ä»…WebSocket | `python run.py --mode=websocket` | 8081 | å®æ—¶é€šä¿¡ |
| æ‰¹å¤„ç†å¯åŠ¨ | `start_back.bat` | 8081+8082 | Windows |

## ğŸ“Š æ•°æ®æµç¨‹å›¾

```
æ–‡ä»¶åˆ†ææµç¨‹:
ä¸Šä¼ æ–‡ä»¶ â†’ æ–‡æ¡£è§£æ â†’ å†…å®¹åˆ†æ â†’ AIåˆ†æ â†’ è·å–ç»“æœ
   â†“         â†“         â†“         â†“         â†“
POST      GET       POST      POST      GET
/upload   /parsing  /analyze  /ai-analyze /result

å®æ—¶é€šä¿¡æµç¨‹:
è¿æ¥å»ºç«‹ â†’ å¿ƒè·³æ£€æµ‹ â†’ æ¶ˆæ¯äº¤äº’ â†’ çŠ¶æ€æ›´æ–° â†’ æ–­å¼€è¿æ¥
   â†“         â†“         â†“         â†“         â†“
connect   ping/pong   chat    progress  disconnect
```

## ğŸ”§ å¿«é€Ÿæµ‹è¯•

### æµ‹è¯•APIæœåŠ¡å™¨
```bash
# å¥åº·æ£€æŸ¥
curl http://localhost:8082/api/health

# èŠå¤©æµ‹è¯•
curl -X POST http://localhost:8082/api/chat \
  -H "Content-Type: application/json" \
  -d '{"message":"ä½ å¥½"}'
```

### æµ‹è¯•WebSocket
```javascript
// æµè§ˆå™¨æ§åˆ¶å°æµ‹è¯•
const socket = io('http://localhost:8081');
socket.on('connected', (data) => console.log('è¿æ¥æˆåŠŸ:', data));
socket.emit('chat', {message: 'ä½ å¥½', session_id: 'test'});
```

## ğŸ“ å¸¸ç”¨çŠ¶æ€ç 

| HTTPçŠ¶æ€ç  | å«ä¹‰ | ä¸šåŠ¡çŠ¶æ€ | å«ä¹‰ |
|------------|------|----------|------|
| 200 | æˆåŠŸ | success: true | æ“ä½œæˆåŠŸ |
| 400 | è¯·æ±‚é”™è¯¯ | success: false | æ“ä½œå¤±è´¥ |
| 404 | ä¸å­˜åœ¨ | status: "completed" | ä»»åŠ¡å®Œæˆ |
| 500 | æœåŠ¡å™¨é”™è¯¯ | status: "failed" | ä»»åŠ¡å¤±è´¥ |

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

| åŠŸèƒ½æ¨¡å— | ç›¸å…³æ¥å£ | è¯´æ˜ |
|----------|----------|------|
| èŠå¤©å¯¹è¯ | `/api/chat`, `chatäº‹ä»¶` | AIæ™ºèƒ½å¯¹è¯ |
| æ–‡ä»¶å¤„ç† | `/api/file/*` | æ–‡æ¡£ä¸Šä¼ åˆ†æ |
| ä¼šè¯ç®¡ç† | `/api/sessions/*` | å¯¹è¯å†å² |
| å®æ—¶é€šä¿¡ | WebSocketäº‹ä»¶ | åŒå‘é€šä¿¡ |
| çŠ¶æ€ç›‘æ§ | `/api/health`, `get_status` | æœåŠ¡ç›‘æ§ |

---

**æ€»è®¡**: HTTPæ¥å£ **13ä¸ª** + WebSocketäº‹ä»¶ **13ä¸ª** = **26ä¸ªæ¥å£/äº‹ä»¶** 