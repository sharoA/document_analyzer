{# Serviceæ¥å£å®ç°ä¸“é—¨æç¤ºè¯æ¨¡æ¿ #}

{% macro service_implementation_prompt(interface_name, service_interface_methods, request_params, response_params, business_logic, project_context) %}
# ğŸ—ï¸ Serviceæ¥å£å®ç°ä»£ç ç”Ÿæˆä¸“å®¶

ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„Spring Boot Serviceå±‚ä»£ç ç”Ÿæˆä¸“å®¶ï¼Œä¸“é—¨è´Ÿè´£ç”ŸæˆServiceImplå®ç°ç±»ã€‚

## ğŸ“‹ ç”Ÿæˆä»»åŠ¡
ä¸ºServiceæ¥å£ç”Ÿæˆå®Œæ•´çš„ServiceImplå®ç°ç±»ï¼Œç¡®ä¿å®ç°æ‰€æœ‰æ¥å£æ–¹æ³•ã€‚

### åŸºæœ¬ä¿¡æ¯
- **æ¥å£åç§°**: {{ interface_name }}
- **ä¸šåŠ¡æè¿°**: {{ business_logic }}
- **é¡¹ç›®åŒ…ç»“æ„**: {{ project_context.get('package_patterns', {}).get('base_package', 'com.example') }}

### Serviceæ¥å£æ–¹æ³•åˆ—è¡¨
{% for method in service_interface_methods %}
- **æ–¹æ³•å**: {{ method.name }}
- **è¿”å›ç±»å‹**: {{ method.return_type }}
- **å‚æ•°åˆ—è¡¨**: {{ method.parameters }}
- **æ–¹æ³•æè¿°**: {{ method.description }}
{% endfor %}

### è¯·æ±‚å‚æ•°ç»“æ„
```json
{{ request_params | tojson }}
```

### å“åº”å‚æ•°ç»“æ„
```json
{{ response_params | tojson }}
```

## ğŸ¯ å®ç°è¦æ±‚

### 1. å¿…é¡»å®ç°çš„æ–¹æ³•
**é‡è¦**: ServiceImplç±»å¿…é¡»å®ç°Serviceæ¥å£ä¸­å®šä¹‰çš„æ‰€æœ‰æ–¹æ³•ï¼Œç‰¹åˆ«æ˜¯ï¼š
{% for method in service_interface_methods %}
- `{{ method.return_type }} {{ method.name }}({{ method.parameters }})`
{% endfor %}

### 2. ä»£ç å®ç°æ ‡å‡†
- ä½¿ç”¨ `@Service` å’Œ `@Transactional` æ³¨è§£
- æ³¨å…¥ç›¸åº”çš„Mapperä¾èµ–
- å®ç°å®Œæ•´çš„ä¸šåŠ¡é€»è¾‘
- æ·»åŠ å¼‚å¸¸å¤„ç†å’Œæ—¥å¿—è®°å½•
- æ”¯æŒåˆ†é¡µæŸ¥è¯¢ï¼ˆå¦‚æœéœ€è¦ï¼‰
- å‚æ•°éªŒè¯å’Œæ•°æ®è½¬æ¢

### 3. Mapperè°ƒç”¨è§„èŒƒ
- è°ƒç”¨çš„Mapperæ–¹æ³•å¿…é¡»ä¸Mapperæ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•ä¸€è‡´
- ä½¿ç”¨åˆé€‚çš„æŸ¥è¯¢æ¡ä»¶å‚æ•°
- å¤„ç†ç©ºå€¼å’Œå¼‚å¸¸æƒ…å†µ

### 4. è¾“å‡ºæ ¼å¼
```java
package {{ project_context.get('package_patterns', {}).get('base_package', 'com.example') }}.application.service.impl;

import {{ project_context.get('package_patterns', {}).get('base_package', 'com.example') }}.application.service.{{ interface_name }}Service;
import {{ project_context.get('package_patterns', {}).get('base_package', 'com.example') }}.domain.entity.{{ interface_name }};
import {{ project_context.get('package_patterns', {}).get('base_package', 'com.example') }}.domain.mapper.{{ interface_name }}Mapper;
import {{ project_context.get('package_patterns', {}).get('base_package', 'com.example') }}.interfaces.dto.{{ interface_name }}Req;
import {{ project_context.get('package_patterns', {}).get('base_package', 'com.example') }}.interfaces.dto.{{ interface_name }}Resp;
import com.github.pagehelper.PageHelper;
import com.github.pagehelper.PageInfo;
import org.springframework.stereotype.Service;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.transaction.annotation.Transactional;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import java.util.List;
import java.util.stream.Collectors;

/**
 * {{ interface_name }} Service Implementation
 * {{ business_logic }}
 */
@Service
@Transactional
public class {{ interface_name }}ServiceImpl implements {{ interface_name }}Service {
    
    private static final Logger logger = LoggerFactory.getLogger({{ interface_name }}ServiceImpl.class);
    
    @Autowired
    private {{ interface_name }}Mapper {{ interface_name.lower() }}Mapper;
    
    // å®ç°æ‰€æœ‰Serviceæ¥å£æ–¹æ³•ï¼Œæ–¹æ³•åå¿…é¡»ä¸æ¥å£å®Œå…¨ä¸€è‡´
    {% for method in service_interface_methods %}
    @Override
    public {{ method.return_type }} {{ method.name }}({{ method.parameters }}) {
        logger.info("Executing {{ method.name }} with parameters: {}", request);
        
        try {
            // å…·ä½“çš„ä¸šåŠ¡é€»è¾‘å®ç°
            // è°ƒç”¨Mapperè¿›è¡Œæ•°æ®æŸ¥è¯¢ï¼Œç¡®ä¿Mapperæ–¹æ³•åä¸ServiceImplè°ƒç”¨ä¸€è‡´
            
            logger.info("{{ method.name }} completed successfully");
            return response;
        } catch (Exception e) {
            logger.error("Error in {{ method.name }}: ", e);
            throw new RuntimeException("{{ method.name }} failed", e);
        }
    }
    {% endfor %}
}
```

## ğŸ’¡ å…³é”®è¦æ±‚
1. **æ–¹æ³•åä¸¥æ ¼ä¸€è‡´æ€§**: ServiceImplä¸­çš„æ–¹æ³•åå¿…é¡»ä¸Serviceæ¥å£ä¸­çš„æ–¹æ³•åå®Œå…¨ä¸€è‡´
   - å¦‚æœServiceæ¥å£å®šä¹‰çš„æ–¹æ³•æ˜¯ `CompanyUnitList(CompanyUnitListReq request)`
   - é‚£ä¹ˆServiceImplå¿…é¡»å®ç° `CompanyUnitList(CompanyUnitListReq request)`
   - ç»å¯¹ä¸èƒ½æ”¹å˜æ–¹æ³•åä¸º `queryCompanyUnitList` æˆ–å…¶ä»–åç§°

2. **Mapperæ–¹æ³•è°ƒç”¨ä¸€è‡´æ€§**: ç¡®ä¿ServiceImplè°ƒç”¨çš„Mapperæ–¹æ³•ååœ¨Mapperæ¥å£ä¸­å­˜åœ¨
   - æ¨èä½¿ç”¨æ ‡å‡†æ–¹æ³•åï¼š`selectByCondition`, `selectList`, `selectById` ç­‰
   - é¿å…ä½¿ç”¨å¯èƒ½ä¸å­˜åœ¨çš„æ–¹æ³•å

3. **å®Œæ•´å®ç°**: ä¸èƒ½æœ‰æŠ½è±¡æ–¹æ³•æˆ–æœªå®ç°çš„æ–¹æ³•
4. **ä¸šåŠ¡é€»è¾‘**: æ ¹æ®{{ business_logic }}å®ç°å…·ä½“çš„ä¸šåŠ¡é€»è¾‘
5. **é”™è¯¯å¤„ç†**: æ·»åŠ é€‚å½“çš„å¼‚å¸¸å¤„ç†å’Œæ—¥å¿—è®°å½•

**é‡è¦**: ç”Ÿæˆçš„ServiceImplç±»å¿…é¡»ä¸¥æ ¼å®ç°Serviceæ¥å£ä¸­å®šä¹‰çš„æ‰€æœ‰æ–¹æ³•ï¼Œæ–¹æ³•ç­¾åå¿…é¡»å®Œå…¨åŒ¹é…ã€‚

è¯·ç”Ÿæˆå®Œæ•´çš„ServiceImplå®ç°ç±»ä»£ç ã€‚
{% endmacro %}