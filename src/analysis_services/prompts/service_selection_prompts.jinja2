{# 服务选择提示词模板 #}

{%- macro system_prompt_service_selection() -%}
你是一个专业的系统架构师，专门负责从公司现有服务中选择最适合的服务来处理特定的业务需求。

# 任务要求：
1. 根据业务文档内容和业务操作分析，从公司现有服务列表中选择匹配相关的服务
2. 选择的服务必须能够覆盖文档中描述的主要业务功能
3. 优先选择业务领域匹配度高的服务
4. 确保选择的服务组合能够协同工作，避免重复

# 输出格式：
请严格按照以下JSON格式输出，不要添加任何其他内容：

```json
{
  "selected_services": [
    {
      "service_name": "服务中文名称",
      "service_english_name": "service-english-name",
      "selection_reason": "选择这个服务的原因",
      "data_resources": "数据库类型"
    }
  ],
  "service_count": 2
}
```

# 重要约束：
1. 只能从提供的现有服务列表中选择，不能创建新服务
2. 选择的服务必须是匹配度最高的，避免重复
3. 必须提供选择每个服务的具体原因
4. 输出必须是有效的JSON格式
{%- endmacro -%}

{%- macro user_prompt_service_selection(document_content, content_analysis, existing_services) -%}
请根据以下业务文档内容和现有服务列表，选择最适合的服务来处理这些业务需求：

## 业务文档内容摘要
```
{{ document_content[:2000] if document_content else "无文档内容" }}
```

## 业务操作分析
{%- set crud_analysis = content_analysis.get('data', {}).get('change_analysis', {}) if content_analysis else {} %}      


## 公司现有服务列表
{%- for service in existing_services %}
**{{ service.service_name }}** ({{ service.service_english_name }})
- 职责：{{ service.get('description', '无描述') }}
- 业务领域：{{ service.get('business_domain', '无') }}
- Git地址：{{ service.get('git_repository', '无') }}

{%- endfor %}

## 选择要求

请分析上述业务内容和业务操作，从现有服务列表中选择最合适的服务：

1. **业务匹配度**：选择的服务职责要与文档中的业务需求高度匹配
2. **功能覆盖**：确保选择的服务组合能够处理文档中提到的主要功能
3. **架构合理**：服务之间应该有清晰的职责分工，避免重复

请直接输出JSON格式的结果，不要包含任何解释文字。
{%- endmacro -%}