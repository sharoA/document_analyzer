# æ™ºèƒ½æ–‡æ¡£åˆ†æç³»ç»Ÿ

åŸºäºRediså­˜å‚¨å’ŒHTTPè½®è¯¢çš„æ™ºèƒ½æ–‡æ¡£åˆ†æç³»ç»Ÿï¼Œæ”¯æŒä¸‰é˜¶æ®µåˆ†ææµç¨‹ï¼šæ–‡æ¡£è§£æ â†’ å†…å®¹åˆ†æ â†’ AIæ™ºèƒ½åˆ†æã€‚

## ğŸš€ åŠŸèƒ½ç‰¹æ€§

- **ä¸‰é˜¶æ®µåˆ†ææµç¨‹**ï¼šæ–‡æ¡£è§£æã€å†…å®¹åˆ†æã€AIæ™ºèƒ½åˆ†æ
- **Redisæ•°æ®å­˜å‚¨**ï¼šæ¯ä¸ªèŠ‚ç‚¹æ•°æ®å­˜å‚¨åˆ°Redisï¼Œæ”¯æŒèŠ‚ç‚¹é—´æ•°æ®ä¼ é€’
- **HTTPè½®è¯¢é€šä¿¡**ï¼šç¨³å®šå¯é çš„å‰åç«¯å®æ—¶è¿›åº¦äº¤äº’
- **å¤šæ ¼å¼æ”¯æŒ**ï¼šPDFã€Wordã€Excelã€PowerPointã€Markdownã€TXTç­‰
- **MarkdownæŠ¥å‘Š**ï¼šJSONç»“æœè‡ªåŠ¨è½¬æ¢ä¸ºMarkdownæ ¼å¼å±•ç¤º
- **å®Œæ•´APIæ¥å£**ï¼šç®€åŒ–çš„RESTful APIè®¾è®¡

## ğŸ“ é¡¹ç›®ç»“æ„

```
analyDesign/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ apis/
â”‚   â”‚   â””â”€â”€ analysis_api.py          # æ™ºèƒ½åˆ†æAPIæœåŠ¡
â”‚   â”œâ”€â”€ analysis_services/           # åˆ†ææœåŠ¡æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ document_parser.py       # æ–‡æ¡£è§£ææœåŠ¡
â”‚   â”‚   â”œâ”€â”€ content_analyzer.py      # å†…å®¹åˆ†ææœåŠ¡
â”‚   â”‚   â””â”€â”€ ai_analyzer.py          # AIæ™ºèƒ½åˆ†ææœåŠ¡
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ redis_util.py           # Rediså·¥å…·ç±»
â”œâ”€â”€ frontend/src/components/
â”‚   â””â”€â”€ DocumentAnalysis.vue        # å‰ç«¯åˆ†æç»„ä»¶
â”œâ”€â”€ uploads/                        # æ–‡ä»¶ä¸Šä¼ ç›®å½•
â”‚   â”œâ”€â”€ temp/                       # ä¸´æ—¶æ–‡ä»¶
â”‚   â”œâ”€â”€ cache/                      # ç¼“å­˜æ–‡ä»¶
â”‚   â””â”€â”€ analysis_results/           # åˆ†æç»“æœ
â”œâ”€â”€ logs/                           # æ—¥å¿—ç›®å½•
â”œâ”€â”€ run_analysis_api.py             # APIå¯åŠ¨è„šæœ¬
â”œâ”€â”€ test_analysis_api.py            # APIæµ‹è¯•è„šæœ¬
â””â”€â”€ config.yaml                     # ç³»ç»Ÿé…ç½®æ–‡ä»¶
```

## ğŸ› ï¸ ç¯å¢ƒè¦æ±‚

### åç«¯ä¾èµ–
- Python 3.8+
- Redis æœåŠ¡å™¨
- Flask
- ç«å±±å¼•æ“APIå¯†é’¥

### å‰ç«¯ä¾èµ–
- Node.js 16+
- Vue 2
- Element Plus

## âš™ï¸ é…ç½®è¯´æ˜

### 1. é…ç½®æ–‡ä»¶ (config.yaml)

```yaml
# Redisé…ç½®
redis:
  host: localhost
  port: 6379
  db: 0
  password: ''

# ç«å±±å¼•æ“é…ç½®
volcengine:
  api_key: 'your_api_key_here'
  endpoint: https://ark.cn-beijing.volces.com/api/v3
  model: ep-20241211150018-nh8rw

# æ–‡ä»¶ä¸Šä¼ é…ç½®
file_upload:
  max_size: 52428800  # 50MB
  allowed_extensions: ['.txt', '.md', '.pdf', '.docx', '.doc', '.xlsx', '.xls', '.pptx', '.ppt']

# ç›®å½•é…ç½®
directories:
  uploads: uploads
  temp: uploads/temp
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨RedisæœåŠ¡

```bash
# ä½¿ç”¨Dockerå¯åŠ¨Redisï¼ˆæ¨èï¼‰
docker run -d --name redis -p 6379:6379 redis:latest

# æˆ–è€…ä½¿ç”¨æœ¬åœ°RedisæœåŠ¡
redis-server
```

### 2. é…ç½®ç¯å¢ƒ

```bash
# å®‰è£…Pythonä¾èµ–
pip install -r requirements.txt

# å®‰è£…å‰ç«¯ä¾èµ–
cd frontend
npm install
```

### 3. å¯åŠ¨åç«¯APIæœåŠ¡

```bash
# æ–¹å¼1ï¼šä½¿ç”¨å¯åŠ¨è„šæœ¬
python run_analysis_api.py

# æ–¹å¼2ï¼šç›´æ¥è¿è¡Œ
python -m src.apis.analysis_api
```

### 4. å¯åŠ¨å‰ç«¯æœåŠ¡

```bash
cd frontend
npm run dev
```

### 5. è®¿é—®ç³»ç»Ÿ

- å‰ç«¯ç•Œé¢ï¼šhttp://localhost:3000
- åç«¯APIï¼šhttp://localhost:8082

## ğŸ”§ APIæ¥å£è¯´æ˜

### æ ¸å¿ƒæ¥å£

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| POST | `/api/analysis` | ä¸Šä¼ æ–‡ä»¶å¹¶å¯åŠ¨åˆ†æ |
| GET | `/api/analysis/{task_id}` | è·å–åˆ†æè¿›åº¦ |
| GET | `/api/analysis/{task_id}/result` | è·å–åˆ†æç»“æœï¼ˆMarkdownï¼‰ |
| DELETE | `/api/analysis/{task_id}` | å–æ¶ˆåˆ†æä»»åŠ¡ |
| GET | `/api/health` | å¥åº·æ£€æŸ¥ |

### æ¥å£è¯¦æƒ…

#### 1. å¯åŠ¨åˆ†æ
```http
POST /api/analysis
Content-Type: multipart/form-data

file: [æ–‡ä»¶å†…å®¹]
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "status": "started",
  "task_id": "uuid-string",
  "message": "åˆ†æå·²å¯åŠ¨",
  "basic_info": {
    "filename": "document.pdf",
    "filesize": "2.5MB",
    "file_type": "pdf"
  }
}
```

#### 2. è·å–è¿›åº¦
```http
GET /api/analysis/{task_id}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "task_id": "uuid-string",
  "basic_info": {...},
  "progress": {
    "status": "running",
    "overall_progress": 66,
    "current_stage": "content_analysis",
    "stages": {
      "document_parsing": {
        "status": "completed",
        "progress": 100,
        "message": "æ–‡æ¡£è§£æå®Œæˆ"
      },
      "content_analysis": {
        "status": "running",
        "progress": 50,
        "message": "æ­£åœ¨åˆ†æå†…å®¹..."
      },
      "ai_analysis": {
        "status": "pending",
        "progress": 0,
        "message": "ç­‰å¾…å¼€å§‹"
      }
    }
  }
}
```

#### 3. è·å–ç»“æœ
```http
GET /api/analysis/{task_id}/result
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "status": "success",
  "task_id": "uuid-string",
  "format": "markdown",
  "content": "# æ–‡æ¡£åˆ†ææŠ¥å‘Š...",
  "raw_data": {...}
}
```

## ğŸ—ï¸ åˆ†ææµç¨‹æ¶æ„

### æ•°æ®æµç¨‹

```
æ–‡ä»¶ä¸Šä¼  â†’ Rediså­˜å‚¨åŸºæœ¬ä¿¡æ¯
    â†“
é˜¶æ®µ1ï¼šæ–‡æ¡£è§£æ
    â†“ (ç»“æœå­˜å‚¨åˆ°Redis)
é˜¶æ®µ2ï¼šå†…å®¹åˆ†æ â† (ä»Redisè¯»å–ä¸Šä¸€é˜¶æ®µç»“æœ)
    â†“ (ç»“æœå­˜å‚¨åˆ°Redis)
é˜¶æ®µ3ï¼šAIæ™ºèƒ½åˆ†æ â† (ä»Redisè¯»å–å‰ä¸¤é˜¶æ®µç»“æœ)
    â†“ (æœ€ç»ˆç»“æœå­˜å‚¨åˆ°Redis)
ç»„è£…å®Œæ•´ç»“æœ â†’ JSONè½¬Markdown
```

### Redisæ•°æ®ç»“æ„

```
analysis:{task_id}:basic_info         # åŸºæœ¬ä¿¡æ¯
analysis:{task_id}:progress          # è¿›åº¦ä¿¡æ¯
analysis:{task_id}:document_parsing  # æ–‡æ¡£è§£æç»“æœ
analysis:{task_id}:content_analysis  # å†…å®¹åˆ†æç»“æœ
analysis:{task_id}:ai_analysis       # AIåˆ†æç»“æœ
analysis:{task_id}:result            # æœ€ç»ˆå®Œæ•´ç»“æœ
```

### è½®è¯¢æœºåˆ¶

- **å‰ç«¯è½®è¯¢é¢‘ç‡**ï¼šæ¯2ç§’è½®è¯¢ä¸€æ¬¡è¿›åº¦
- **è‡ªåŠ¨åœæ­¢**ï¼šåˆ†æå®Œæˆæˆ–å¤±è´¥æ—¶åœæ­¢è½®è¯¢
- **é”™è¯¯å¤„ç†**ï¼šç½‘ç»œé”™è¯¯æ—¶è‡ªåŠ¨é‡è¯•
- **çŠ¶æ€æ¢å¤**ï¼šé¡µé¢åˆ·æ–°åå¯æ¢å¤è½®è¯¢çŠ¶æ€

## ğŸ§ª æµ‹è¯•ä¸éªŒè¯

### 1. è¿è¡ŒAPIæµ‹è¯•

```bash
# ç¡®ä¿APIæœåŠ¡æ­£åœ¨è¿è¡Œ
python test_analysis_api.py
```

### 2. æ‰‹åŠ¨æµ‹è¯•æ­¥éª¤

1. **å¥åº·æ£€æŸ¥**ï¼šè®¿é—® http://localhost:8082/api/health
2. **ä¸Šä¼ æ–‡ä»¶**ï¼šä½¿ç”¨å‰ç«¯ç•Œé¢æˆ–Postmanä¸Šä¼ æµ‹è¯•æ–‡ä»¶
3. **ç›‘æ§è¿›åº¦**ï¼šè§‚å¯Ÿä¸‰ä¸ªé˜¶æ®µçš„è¿›åº¦å˜åŒ–
4. **æŸ¥çœ‹ç»“æœ**ï¼šåˆ†æå®ŒæˆåæŸ¥çœ‹Markdownæ ¼å¼æŠ¥å‘Š

### 3. æµ‹è¯•æ–‡ä»¶ç¤ºä¾‹

æ”¯æŒä¸Šä¼ å„ç§æ ¼å¼çš„æ–‡æ¡£æ–‡ä»¶ï¼š
- éœ€æ±‚æ–‡æ¡£ï¼ˆWord/PDFï¼‰
- æŠ€æœ¯æ–‡æ¡£ï¼ˆMarkdownï¼‰
- æ•°æ®è¡¨æ ¼ï¼ˆExcelï¼‰
- æ¼”ç¤ºæ–‡ç¨¿ï¼ˆPowerPointï¼‰

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **Redisè¿æ¥å¤±è´¥**
   - æ£€æŸ¥RedisæœåŠ¡æ˜¯å¦å¯åŠ¨
   - ç¡®è®¤é…ç½®æ–‡ä»¶ä¸­çš„Redisè¿æ¥ä¿¡æ¯

2. **ç«å±±å¼•æ“APIé”™è¯¯**
   - æ£€æŸ¥APIå¯†é’¥æ˜¯å¦æ­£ç¡®
   - ç¡®è®¤ç½‘ç»œè¿æ¥å’Œè®¿é—®æƒé™

3. **æ–‡ä»¶ä¸Šä¼ å¤±è´¥**
   - æ£€æŸ¥æ–‡ä»¶æ ¼å¼æ˜¯å¦æ”¯æŒ
   - ç¡®è®¤æ–‡ä»¶å¤§å°ä¸è¶…è¿‡é™åˆ¶

4. **åˆ†æè¿›åº¦å¡ä½**
   - æŸ¥çœ‹åç«¯æ—¥å¿—äº†è§£å…·ä½“é”™è¯¯
   - æ£€æŸ¥åˆ†ææœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ

### æ—¥å¿—æŸ¥çœ‹

```bash
# æŸ¥çœ‹APIæœåŠ¡æ—¥å¿—
tail -f logs/api_server.log

# æŸ¥çœ‹åˆ†ææœåŠ¡æ—¥å¿—
tail -f logs/analysis_service.log
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### Redisä¼˜åŒ–
- è®¾ç½®åˆç†çš„è¿‡æœŸæ—¶é—´ï¼ˆ24å°æ—¶ï¼‰
- ä½¿ç”¨è¿æ¥æ± æé«˜å¹¶å‘æ€§èƒ½
- ç›‘æ§å†…å­˜ä½¿ç”¨æƒ…å†µ

### APIä¼˜åŒ–
- ä½¿ç”¨çº¿ç¨‹æ± å¤„ç†åå°åˆ†æä»»åŠ¡
- å®ç°ä»»åŠ¡é˜Ÿåˆ—æœºåˆ¶é˜²æ­¢è¿‡è½½
- æ·»åŠ ç¼“å­˜å‡å°‘é‡å¤è®¡ç®—

### å‰ç«¯ä¼˜åŒ–
- æ™ºèƒ½è½®è¯¢é¢‘ç‡è°ƒæ•´
- ç»„ä»¶åŒ–åˆ†æç•Œé¢
- ç»“æœç¼“å­˜æœºåˆ¶

## ğŸ”® æ‰©å±•åŠŸèƒ½

### è®¡åˆ’ä¸­çš„åŠŸèƒ½
- [ ] æ”¯æŒæ‰¹é‡æ–‡ä»¶åˆ†æ
- [ ] åˆ†æç»“æœå¯¹æ¯”åŠŸèƒ½
- [ ] è‡ªå®šä¹‰åˆ†ææ¨¡æ¿
- [ ] åˆ†æå†å²ç®¡ç†
- [ ] å¯¼å‡ºå¤šç§æ ¼å¼æŠ¥å‘Š

### é›†æˆå»ºè®®
- é›†æˆåˆ°ç°æœ‰æ–‡æ¡£ç®¡ç†ç³»ç»Ÿ
- æ”¯æŒä¼ä¸šçº§èº«ä»½è®¤è¯
- æ·»åŠ å®¡æ‰¹æµç¨‹ç®¡ç†
- é›†æˆé€šçŸ¥æ¨é€åŠŸèƒ½

## ğŸ“ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤é—®é¢˜å’ŒåŠŸèƒ½è¯·æ±‚ï¼è¯·æŸ¥çœ‹ [CONTRIBUTING.md](CONTRIBUTING.md) äº†è§£è´¡çŒ®æŒ‡å—ã€‚

---

**è”ç³»æ–¹å¼**ï¼šå¦‚æœ‰é—®é¢˜è¯·æäº¤ Issue æˆ–å‘é€é‚®ä»¶è‡³ [your-email@example.com] 